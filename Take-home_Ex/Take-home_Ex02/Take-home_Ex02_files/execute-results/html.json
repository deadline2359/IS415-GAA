{
  "hash": "a6c9f3230e8eab5ee2a016ed5cf600a1",
  "result": {
    "markdown": "---\ntitle: \"Take-home Exercise 2\"\nformat: \n  html:\n    code-line-numbers: true\n    number-sections: true\n    highlight-style: github\nexecute:\n  warning: false\n  echo: true  \n  eval: true\neditor: visual\ndate: \"13 February 2023\"\ndate-modified: \"2023-02-26\"\n---\n\n::: {.cell}\n<style type=\"text/css\">\n.panel-tabset .nav-link {\n  background-color: #a3d2e3;\n  box-shadow: 8px 5px 5px darkgrey;\n}\n\n.panel-tabset .tab-content{\n  box-shadow: 8px 5px 5px darkgrey;\n}\n</style>\n:::\n\n\n::: callout-warning\nOnly import first or last of the month\n\nA ***rukun tetangga*** (abbrievated **RT**, literally \"pillar of neighbours\") is an administrative division of a village in [Indonesia](https://en.wikipedia.org/wiki/Indonesia \"Indonesia\"), under a [*rukun warga*](https://en.wikipedia.org/wiki/Rukun_warga \"Rukun warga\"). The RT is the lowest administrative division of Indonesia.\n\n-   use lesson 6\n\n-   use hot and cold spots\n:::\n\n# R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, sfdep, tmap, tidyverse, readxl, spdep, dplyr)\n```\n:::\n\n\n# Importing\n\n## Aspatial Dataset\n\n::: panel-tabset\n### Jul 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\njul2021 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (31 Juli 2021).xlsx\", sheet = \"Data Kelurahan\")\njul2021[\"Date\"] <- \"2021-07-00\"\nhead(jul2021, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 4441501 4499710 1663218 6162928\n2 3172051003     JAKART… PADEMA… ANCOL     23947   12333   11614    4181   15795\n3 3173041007     JAKART… TAMBORA ANGKE     29381   13875   15506    4798   20304\n4 3175041005     JAKART… KRAMAT… BALE K…   29074   18314   10760    3658   14418\n5 3175031003     JAKART… JATINE… BALI M…    9752    5173    4579    2007    6586\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Aug 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\naug2021 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (31 Agustus 2021).xlsx\", sheet = \"Data Kelurahan\")\naug2021[\"Date\"] <- \"2021-08-00\"\nhead(aug2021, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 3277484 5663727 3412906 9076633\n2 3172051003     JAKART… PADEMA… ANCOL     23947    9191   14756    8935   23691\n3 3173041007     JAKART… TAMBORA ANGKE     29381   10400   18981   10470   29451\n4 3175041005     JAKART… KRAMAT… BALE K…   29074   12510   16564    7766   24330\n5 3175031003     JAKART… JATINE… BALI M…    9752    3704    6048    3671    9719\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Sep 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsep2021 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (30 September 2021).xlsx\", sheet = \"Data Kelurahan\")\nsep2021[\"Date\"] <- \"2021-09-00\"\nhead(sep2021, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 2235772 6705439 5171697  1.19e7\n2 3172051003     JAKART… PADEMA… ANCOL     23947    6688   17259   13376  3.06e4\n3 3173041007     JAKART… TAMBORA ANGKE     29381    7581   21800   16438  3.82e4\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    8708   20366   14412  3.48e4\n5 3175031003     JAKART… JATINE… BALI M…    9752    2517    7235    5660  1.29e4\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Oct 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\noct2021 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (31 Oktober 2021).xlsx\", sheet = \"Data Kelurahan\")\noct2021[\"Date\"] <- \"2021-10-00\"\nhead(oct2021, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1880524 7060687 5729001  1.28e7\n2 3172051003     JAKART… PADEMA… ANCOL     23947    5991   17956   14504  3.25e4\n3 3173041007     JAKART… TAMBORA ANGKE     29381    6557   22824   18185  4.10e4\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    7586   21488   16444  3.79e4\n5 3175031003     JAKART… JATINE… BALI M…    9752    2125    7627    6277  1.39e4\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Nov 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnov2021 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (30 November 2021).xlsx\", sheet = \"Data Kelurahan\")\nnov2021[\"Date\"] <- \"2021-11-00\"\nhead(nov2021, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1723821 7217390 6172636  1.34e7\n2 3172051003     JAKART… PADEMA… ANCOL     23947    5527   18420   15466  3.39e4\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5986   23395   19404  4.28e4\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    6802   22272   18084  4.04e4\n5 3175031003     JAKART… JATINE… BALI M…    9752    1920    7832    6773  1.46e4\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Dec 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndec2021 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (31 Desember 2021).xlsx\", sheet = \"Data Kelurahan\")\ndec2021[\"Date\"] <- \"2021-12-00\"\nhead(dec2021, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1623736 7317475 6370175  1.37e7\n2 3172051003     JAKART… PADEMA… ANCOL     23947    5062   18885   15996  3.49e4\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5626   23755   20026  4.38e4\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    6335   22739   18925  4.17e4\n5 3175031003     JAKART… JATINE… BALI M…    9752    1782    7970    7003  1.50e4\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Jan 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\njan2022 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (31 Januari 2022).xlsx\", sheet = \"Data Kelurahan\")\njan2022[\"Date\"] <- \"2022-01-00\"\nhead(jan2022, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1538221 7402990 6516678  1.39e7\n2 3172051003     JAKART… PADEMA… ANCOL     23947    4647   19300   16477  3.58e4\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5388   23993   20463  4.45e4\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    5967   23107   19468  4.26e4\n5 3175031003     JAKART… JATINE… BALI M…    9752    1678    8074    7176  1.52e4\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Feb 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfeb2022 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (27 Februari 2022).xlsx\", sheet = \"Data Kelurahan\")\nfeb2022[\"Date\"] <- \"2022-02-00\"\nhead(feb2022, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1517196 7424015 6590380  1.40e7\n2 3172051003     JAKART… PADEMA… ANCOL     23947    4592   19355   16687  3.60e4\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5319   24062   20738  4.48e4\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    5903   23171   19754  4.29e4\n5 3175031003     JAKART… JATINE… BALI M…    9752    1649    8103    7245  1.53e4\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Mar 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmar2022 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (31 Maret 2022).xlsx\", sheet = \"Data Kelurahan\")\nmar2022[\"Date\"] <- \"2022-03-00\"\nhead(mar2022, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 35\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ JUMLA…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1482471 7458740 6682911 1836511\n2 3172051003     JAKART… PADEMA… ANCOL     23947    4522   19425   16909    3934\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5186   24195   21000    6122\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    5780   23294   20123    4124\n5 3175031003     JAKART… JATINE… BALI M…    9752    1621    8131    7332    2159\n# … with 26 more variables: `TOTAL VAKSIN\\r\\nDIBERIKAN` <dbl>,\n#   `LANSIA\\r\\nDOSIS 1` <dbl>, `LANSIA\\r\\nDOSIS 2` <dbl>,\n#   `LANSIA\\r\\nDOSIS 3` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 3` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Apr 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\napr2022 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (30 April 2022).xlsx\", sheet = \"Data Kelurahan\")\napr2022[\"Date\"] <- \"2022-04-00\"\nhead(apr2022, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 35\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ JUMLA…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1453423 7487788 6727002 2720796\n2 3172051003     JAKART… PADEMA… ANCOL     23947    4449   19498   17027    6568\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5101   24280   21134    8915\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    5699   23375   20315    6491\n5 3175031003     JAKART… JATINE… BALI M…    9752    1598    8154    7395    3225\n# … with 26 more variables: `TOTAL VAKSIN\\r\\nDIBERIKAN` <dbl>,\n#   `LANSIA\\r\\nDOSIS 1` <dbl>, `LANSIA\\r\\nDOSIS 2` <dbl>,\n#   `LANSIA\\r\\nDOSIS 3` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 3` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Mei 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmay2022 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (31 Mei 2022).xlsx\", sheet = \"Data Kelurahan\")\nmay2022[\"Date\"] <- \"2022-05-00\"\nhead(may2022, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 35\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ JUMLA…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1445540 7495671 6743764 2885301\n2 3172051003     JAKART… PADEMA… ANCOL     23947    4440   19507   17077    7022\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5084   24297   21182    9484\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    5676   23398   20373    7030\n5 3175031003     JAKART… JATINE… BALI M…    9752    1589    8163    7413    3413\n# … with 26 more variables: `TOTAL VAKSIN\\r\\nDIBERIKAN` <dbl>,\n#   `LANSIA\\r\\nDOSIS 1` <dbl>, `LANSIA\\r\\nDOSIS 2` <dbl>,\n#   `LANSIA\\r\\nDOSIS 3` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 3` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n### Jun 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\njun2022 <- read_excel(\"data/aspatial/Data Vaksinasi Berbasis Kelurahan (30 Juni 2022).xlsx\", sheet = \"Data Kelurahan\")\njun2022[\"Date\"] <- \"2022-06-00\"\nhead(jun2022, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 35\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ JUMLA…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 <NA>           <NA>    <NA>    TOTAL   8941211 1431393 7509818 6756584 3031594\n2 3172051003     JAKART… PADEMA… ANCOL     23947    4402   19545   17106    7369\n3 3173041007     JAKART… TAMBORA ANGKE     29381    5041   24340   21213   10086\n4 3175041005     JAKART… KRAMAT… BALE K…   29074    5632   23442   20416    7398\n5 3175031003     JAKART… JATINE… BALI M…    9752    1576    8176    7427    3602\n# … with 26 more variables: `TOTAL VAKSIN\\r\\nDIBERIKAN` <dbl>,\n#   `LANSIA\\r\\nDOSIS 1` <dbl>, `LANSIA\\r\\nDOSIS 2` <dbl>,\n#   `LANSIA\\r\\nDOSIS 3` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 3` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n:::\n\n## Geospatial Dataset\n\n::: panel-tabset\n### Importing\n\nThe EPSG code for Indonesia is 23845.\n\n\n::: {.cell}\n\n```{.r .cell-code}\njakarta_boundary <- st_read(dsn = \"data/geospatial\", \n                 layer = \"BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA\") %>% \n  select(c(1:9)) %>% \n  st_transform(crs = 23845) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA' from data source \n  `C:\\deadline2359\\IS415-GAA\\Take-home_Ex\\Take-home_Ex02\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 269 features and 161 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 106.3831 ymin: -6.370815 xmax: 106.9728 ymax: -5.184322\nGeodetic CRS:  WGS 84\n```\n:::\n:::\n\n\n### Dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(jakarta_boundary, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 5 features and 9 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -3667896 ymin: 689350.6 xmax: -3619528 ymax: 751796\nProjected CRS: DGN95 / Indonesia TM-3 zone 54.1\n  OBJECT_ID  KODE_DESA           DESA   KODE    PROVINSI         KAB_KOTA\n1     25477 3173031006      KEAGUNGAN 317303 DKI JAKARTA    JAKARTA BARAT\n2     25478 3173031007         GLODOK 317303 DKI JAKARTA    JAKARTA BARAT\n3     25397 3171031003  HARAPAN MULIA 317103 DKI JAKARTA    JAKARTA PUSAT\n4     25400 3171031006   CEMPAKA BARU 317103 DKI JAKARTA    JAKARTA PUSAT\n5     25378 3101011001 PULAU PANGGANG 310101 DKI JAKARTA KEPULAUAN SERIBU\n               KECAMATAN     DESA_KELUR JUMLAH_PEN\n1             TAMAN SARI      KEAGUNGAN      21609\n2             TAMAN SARI         GLODOK       9069\n3              KEMAYORAN  HARAPAN MULIA      29085\n4              KEMAYORAN   CEMPAKA BARU      41913\n5 KEPULAUAN SERIBU UTARA PULAU PANGGANG       6947\n                        geometry\n1 MULTIPOLYGON (((-3626874 69...\n2 MULTIPOLYGON (((-3627130 69...\n3 MULTIPOLYGON (((-3621251 68...\n4 MULTIPOLYGON (((-3620608 69...\n5 MULTIPOLYGON (((-3667409 74...\n```\n:::\n:::\n\n:::\n\n# Data Preparation\n\n## Combine\n\nYou may realise that the dataframes from the months March to June in 2022 have 35 columns in total. Whereas the months before have only 28. Note that all dataframes have been added an additional one \"date\" column stating their month.\n\nSince we will not have any data on these extra 7 columns, we will pick out find the common 28 columns and slice the dataframes before combining all together.\n\n::: panel-tabset\n### Combining Months\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolumn_name28 <- names(jul2021)\ncolumn_name35 <- names(jun2022)\noverlapped_cols = intersect(column_name28, column_name35)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvaccine_months_list <- list(jul2021, aug2021, sep2021, oct2021, nov2021, dec2021, jan2022, feb2022, mar2022, apr2022, may2022, jun2022)\n\nvaccine_months <- data.frame()\n\nfor (month in vaccine_months_list) {\n  vaccine_months <- rbind(vaccine_months, month[2:nrow(month),overlapped_cols])\n}\n```\n:::\n\n\n### Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(vaccine_months, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 28\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 3172051003     JAKART… PADEMA… ANCOL     23947   12333   11614    4181   15795\n2 3173041007     JAKART… TAMBORA ANGKE     29381   13875   15506    4798   20304\n3 3175041005     JAKART… KRAMAT… BALE K…   29074   18314   10760    3658   14418\n4 3175031003     JAKART… JATINE… BALI M…    9752    5173    4579    2007    6586\n5 3175101006     JAKART… CIPAYU… BAMBU …   26285   13775   12510    5206   17716\n# … with 19 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n:::\n\nConsidering that the columns are in Bahasa Indonesia, you may want to check out the translations to better understand the process.\n\n::: {.callout-tip collapse=\"true\"}\n### Translations of Column Names\n\n| Bahasa Indonesia                        |                            English |\n|-------------------------------------|----------------------------------:|\n| Kode Kelurahan                          |                  Sub-district Code |\n| Wilayah Kota                            |                          City Area |\n| Kecamatan                               |                       Sub-district |\n| Sasaran                                 |                             Target |\n| Belum Vaksin                            |               Yet to be Vaccinated |\n| Jumlah Dosis 1                          |                 Number of Dosage 1 |\n| Jumlah Dosis 2                          |                 Number of Dosage 2 |\n| Total Vaksin Diberikan                  |               Total Vaccines Given |\n| Lansia Dosis 1                          |                   Elderly Dosage 1 |\n| Lansia Dosis 2                          |                   Elderly Dosage 2 |\n| Lansia Total Vaksin Diberikan           |        Total Elderly Vaccine Given |\n| Pelayan Publik Dosis 1                  |            Public Servant Dosage 1 |\n| Pelayan Publik Dosis 2                  |            Public Servant Dosage 2 |\n| Pelayan Publik Total Vaksin Diberikan   | Total Public Servant Vaccine Given |\n| Gotong Royong Dosis 1                   |                Mutual Aid Dosage 1 |\n| Gotong Royong Dosis 2                   |                Mutual Aid Dosage 2 |\n| Gotong Royong Total Vaksin Diberikan    |     Total Mutual Aid Vaccine Given |\n| Tenaga Kesehatan Dosis 1                |            Health Workers Dosage 1 |\n| Tenaga Kesehatan Dosis 2                |            Health Workers Dosage 2 |\n| Tenaga Kesehatan Total Vaksin Diberikan | Total Health Workers Vaccine Given |\n| Tahapan 3 Dosis 1                       |                   Stage 3 Dosage 1 |\n| Tahapan 3 Dosis 2                       |                   Stage 3 Dosage 2 |\n| Tahapan 3 Total Vaksin Diberikan        |        Total Stage 3 Vaccine Given |\n| Remaja Dosis 1                          |                  Teenager Dosage 1 |\n| Remaja Dosis 2                          |                  Teenager Dosage 2 |\n| Remaja Total Vaksin Diberikan           |       Total Teenager Vaccine Given |\n:::\n\n## Create Monthly Vaccination Rate\n\nThere is a total of 267 kelurahan or urban villages in the Special Capital Region of Jakarta.\n\n$$\n267kelurahan \\times 12 months = 3204\n$$\n\nWe can tell that we have the correct number of rows in our final dataframe, *vaccine_months*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(vaccine_months)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3204\n```\n:::\n:::\n\n\n### Calculate Monthly Vaccination Rate\n\nWe will need to create a column with the vaccination rates of each village in order to map a choropleth map.\n\nSince *\"Sasaran\"* is the target number of vaccinations provided and *\"Belum Vaksin\"* tells of the number of people not yet vaccinated, we can derive vaccination rates of each month.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvaccine_months[\"vaccination rate\"] <- (vaccine_months[\"SASARAN\"] - vaccine_months[\"BELUM VAKSIN\"])/vaccine_months[\"SASARAN\"] * 100\n```\n:::\n\n\n## Joining of Geospatial and Aspatial Datasets\n\nAs mentioned we want to visualise the vaccination rates on the map Of Jakarta, this will require us to join the two existing dataframes in order to have a complete dataframe for the map.\n\nWe will join the two dataframes using \"KELURAHAN\" in *vaccine_months* and \"DESA\" in *jakarta_boundary*, both meaning village.\n\n\n::: {.cell}\n\n```{.r .cell-code}\njakarta <- left_join(vaccine_months, jakarta_boundary, by=c(\"KODE KELURAHAN\"=\"KODE_DESA\"))\n\njakarta <- na.omit(jakarta[jakarta[\"KAB_KOTA\"] != (\"KEPULAUAN SERIBU\"), ])\n\nhead(jakarta, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 38\n  KODE KELURAH…¹ WILAY…² KECAM…³ KELUR…⁴ SASARAN BELUM…⁵ JUMLA…⁶ JUMLA…⁷ TOTAL…⁸\n  <chr>          <chr>   <chr>   <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 3172051003     JAKART… PADEMA… ANCOL     23947   12333   11614    4181   15795\n2 3173041007     JAKART… TAMBORA ANGKE     29381   13875   15506    4798   20304\n3 3175041005     JAKART… KRAMAT… BALE K…   29074   18314   10760    3658   14418\n4 3175031003     JAKART… JATINE… BALI M…    9752    5173    4579    2007    6586\n5 3175101006     JAKART… CIPAYU… BAMBU …   26285   13775   12510    5206   17716\n# … with 29 more variables: `LANSIA\\r\\nDOSIS 1` <dbl>,\n#   `LANSIA\\r\\nDOSIS 2` <dbl>, `LANSIA TOTAL \\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `PELAYAN PUBLIK\\r\\nDOSIS 1` <dbl>, `PELAYAN PUBLIK\\r\\nDOSIS 2` <dbl>,\n#   `PELAYAN PUBLIK TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `GOTONG ROYONG\\r\\nDOSIS 1` <dbl>, `GOTONG ROYONG\\r\\nDOSIS 2` <dbl>,\n#   `GOTONG ROYONG TOTAL\\r\\nVAKSIN DIBERIKAN` <dbl>,\n#   `TENAGA KESEHATAN\\r\\nDOSIS 1` <dbl>, `TENAGA KESEHATAN\\r\\nDOSIS 2` <dbl>, …\n```\n:::\n:::\n\n\n#  Visualisation of Vaccination Rates\n::: {.panel-tabset}\n\n## Jul 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2021-07-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (July 2021)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n## Aug 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2021-08-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (August 2021)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n## Sep 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2021-09-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (September 2021)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n## Oct 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2021-10-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (October 2021)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n## Nov 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2021-11-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (November 2021)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n## Dec 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2021-12-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (December 2021)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n## Jan 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2022-01-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (January 2022)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n## Feb 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2022-02-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (February 2022)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n## Mar 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2022-03-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (March 2022)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n## Apr 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2022-04-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (April 2022)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n## May 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2022-05-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (May 2022)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n## Jun 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonth_vaccination_rate <- st_as_sf(jakarta[jakarta$\"Date\" == \"2022-06-00\",])\ntm_shape(month_vaccination_rate) +\n  tm_fill(\"vaccination rate\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Vaccination Rates in Jakarta (June 2022)\",\n            main.title.size = 1.10,\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n:::\n\n# Local Gi* Analysis\n\n## Deriving Centroid\n\n\n::: {.cell}\n\n```{.r .cell-code}\njakarta_clean_boundary <- jakarta_boundary %>%  \n  na.omit() %>% \n  dplyr::filter(KAB_KOTA != \"KEPULAUAN SERIBU\")\n\nlongitude <- map_dbl(jakarta_clean_boundary$geometry, ~st_centroid(.x)[[1]])\n\nlatitude <- map_dbl(jakarta_clean_boundary$geometry, ~st_centroid(.x)[[2]])\n\ncoords <- cbind(longitude, latitude)\n```\n:::\n\n\n## Determine Cut-off Distance\n\n::: {.cell}\n\n```{.r .cell-code}\nk1 <- knn2nb(knearneigh(coords))\nk1dists <- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   1430    7313   10177   10677   14112   19842 \n```\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}