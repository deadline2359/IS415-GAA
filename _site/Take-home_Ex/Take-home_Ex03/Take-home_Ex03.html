<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-18">

<title>Ailys’ IS415 Journey - Take-home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ailys’ IS415 Journey</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-On Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07.1/Hands-on_Ex07.1.html">
 <span class="dropdown-text">Hands-on Exercise 7.1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07.2/Hands-on_Ex07.2.html">
 <span class="dropdown-text">Hands-on Exercise 7.2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex11/Hands-on_Ex11.html">
 <span class="dropdown-text">Hands-on Exercise 11</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex11/In-class_Ex11.html">
 <span class="dropdown-text">In-class Exercise 11</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#import-packages" id="toc-import-packages" class="nav-link" data-scroll-target="#import-packages"><span class="toc-section-number">2</span>  Import Packages</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="toc-section-number">3</span>  Import Data</a>
  <ul class="collapse">
  <li><a href="#import-hdb-resale-flat-prices" id="toc-import-hdb-resale-flat-prices" class="nav-link" data-scroll-target="#import-hdb-resale-flat-prices"><span class="toc-section-number">3.1</span>  Import HDB Resale Flat Prices</a></li>
  <li><a href="#import-subzone-data" id="toc-import-subzone-data" class="nav-link" data-scroll-target="#import-subzone-data"><span class="toc-section-number">3.2</span>  Import Subzone Data</a></li>
  <li><a href="#import-independent-variables" id="toc-import-independent-variables" class="nav-link" data-scroll-target="#import-independent-variables"><span class="toc-section-number">3.3</span>  Import Independent Variables</a>
  <ul class="collapse">
  <li><a href="#geospatial-datasets" id="toc-geospatial-datasets" class="nav-link" data-scroll-target="#geospatial-datasets"><span class="toc-section-number">3.3.1</span>  Geospatial Datasets</a></li>
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data"><span class="toc-section-number">3.3.5</span>  Aspatial Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="toc-section-number">4</span>  Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#central-business-district" id="toc-central-business-district" class="nav-link" data-scroll-target="#central-business-district"><span class="toc-section-number">4.0.1</span>  Central Business District</a></li>
  <li><a href="#mpsz" id="toc-mpsz" class="nav-link" data-scroll-target="#mpsz"><span class="toc-section-number">4.1</span>  MPSZ</a></li>
  <li><a href="#mrt" id="toc-mrt" class="nav-link" data-scroll-target="#mrt"><span class="toc-section-number">4.2</span>  MRT</a></li>
  <li><a href="#get-coordinates-for-hdb" id="toc-get-coordinates-for-hdb" class="nav-link" data-scroll-target="#get-coordinates-for-hdb"><span class="toc-section-number">4.3</span>  Get Coordinates for HDB</a>
  <ul class="collapse">
  <li><a href="#merge-with-hdb-status" id="toc-merge-with-hdb-status" class="nav-link" data-scroll-target="#merge-with-hdb-status"><span class="toc-section-number">4.3.1</span>  Merge with HDB Status</a></li>
  </ul></li>
  <li><a href="#malls-1" id="toc-malls-1" class="nav-link" data-scroll-target="#malls-1"><span class="toc-section-number">4.4</span>  Malls</a></li>
  <li><a href="#top-20-primary-schools" id="toc-top-20-primary-schools" class="nav-link" data-scroll-target="#top-20-primary-schools"><span class="toc-section-number">4.5</span>  Top 20 Primary Schools</a></li>
  </ul></li>
  <li><a href="#acquire-proximity" id="toc-acquire-proximity" class="nav-link" data-scroll-target="#acquire-proximity"><span class="toc-section-number">5</span>  Acquire Proximity</a>
  <ul class="collapse">
  <li><a href="#within-radius" id="toc-within-radius" class="nav-link" data-scroll-target="#within-radius"><span class="toc-section-number">5.1</span>  Within radius</a></li>
  </ul></li>
  <li><a href="#get-proximity-locational-factors" id="toc-get-proximity-locational-factors" class="nav-link" data-scroll-target="#get-proximity-locational-factors"><span class="toc-section-number">6</span>  Get Proximity Locational Factors</a>
  <ul class="collapse">
  <li><a href="#floor-level" id="toc-floor-level" class="nav-link" data-scroll-target="#floor-level"><span class="toc-section-number">6.1</span>  Floor Level</a></li>
  <li><a href="#remaining-lease" id="toc-remaining-lease" class="nav-link" data-scroll-target="#remaining-lease"><span class="toc-section-number">6.2</span>  Remaining Lease</a></li>
  <li><a href="#age-of-unit" id="toc-age-of-unit" class="nav-link" data-scroll-target="#age-of-unit"><span class="toc-section-number">6.3</span>  Age of Unit</a></li>
  <li><a href="#upgrades" id="toc-upgrades" class="nav-link" data-scroll-target="#upgrades"><span class="toc-section-number">6.4</span>  Upgrades</a></li>
  <li><a href="#hdb-types" id="toc-hdb-types" class="nav-link" data-scroll-target="#hdb-types"><span class="toc-section-number">6.5</span>  HDB Types</a></li>
  <li><a href="#save" id="toc-save" class="nav-link" data-scroll-target="#save"><span class="toc-section-number">6.6</span>  save</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="toc-section-number">7</span>  Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#statistical-graphics" id="toc-statistical-graphics" class="nav-link" data-scroll-target="#statistical-graphics"><span class="toc-section-number">7.1</span>  Statistical Graphics</a>
  <ul class="collapse">
  <li><a href="#central-business-district-1" id="toc-central-business-district-1" class="nav-link" data-scroll-target="#central-business-district-1"><span class="toc-section-number">7.1.1</span>  Central Business District</a></li>
  <li><a href="#hawker-centres-1" id="toc-hawker-centres-1" class="nav-link" data-scroll-target="#hawker-centres-1"><span class="toc-section-number">7.1.2</span>  Hawker Centres</a></li>
  <li><a href="#eldercare-centres-1" id="toc-eldercare-centres-1" class="nav-link" data-scroll-target="#eldercare-centres-1"><span class="toc-section-number">7.1.3</span>  Eldercare Centres</a></li>
  <li><a href="#parks-1" id="toc-parks-1" class="nav-link" data-scroll-target="#parks-1"><span class="toc-section-number">7.1.4</span>  Parks</a></li>
  <li><a href="#kindergartens-1" id="toc-kindergartens-1" class="nav-link" data-scroll-target="#kindergartens-1"><span class="toc-section-number">7.1.5</span>  Kindergartens</a></li>
  <li><a href="#childcare-centres-1" id="toc-childcare-centres-1" class="nav-link" data-scroll-target="#childcare-centres-1"><span class="toc-section-number">7.1.6</span>  Childcare Centres</a></li>
  <li><a href="#bus-stops" id="toc-bus-stops" class="nav-link" data-scroll-target="#bus-stops"><span class="toc-section-number">7.1.7</span>  Bus Stops</a></li>
  <li><a href="#mrt-stations-1" id="toc-mrt-stations-1" class="nav-link" data-scroll-target="#mrt-stations-1"><span class="toc-section-number">7.1.8</span>  MRT Stations</a></li>
  <li><a href="#primary-schools" id="toc-primary-schools" class="nav-link" data-scroll-target="#primary-schools"><span class="toc-section-number">7.1.9</span>  Primary Schools</a></li>
  <li><a href="#supermarkets-1" id="toc-supermarkets-1" class="nav-link" data-scroll-target="#supermarkets-1"><span class="toc-section-number">7.1.10</span>  Supermarkets</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ols-multiple-linear-regression-model" id="toc-ols-multiple-linear-regression-model" class="nav-link" data-scroll-target="#ols-multiple-linear-regression-model"><span class="toc-section-number">8</span>  OLS Multiple Linear Regression Model</a>
  <ul class="collapse">
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="toc-section-number">8.1</span>  Filtering</a>
  <ul class="collapse">
  <li><a href="#train" id="toc-train" class="nav-link" data-scroll-target="#train"><span class="toc-section-number">8.1.1</span>  Train</a></li>
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test"><span class="toc-section-number">8.1.2</span>  Test</a></li>
  </ul></li>
  <li><a href="#visualising-the-relationships-of-the-independent-variables" id="toc-visualising-the-relationships-of-the-independent-variables" class="nav-link" data-scroll-target="#visualising-the-relationships-of-the-independent-variables"><span class="toc-section-number">8.2</span>  Visualising the relationships of the independent variables</a></li>
  <li><a href="#preparing-publication-quality-table-gtsummary-method" id="toc-preparing-publication-quality-table-gtsummary-method" class="nav-link" data-scroll-target="#preparing-publication-quality-table-gtsummary-method"><span class="toc-section-number">8.3</span>  Preparing Publication Quality Table: gtsummary method</a></li>
  <li><a href="#checking-for-multicolinearity" id="toc-checking-for-multicolinearity" class="nav-link" data-scroll-target="#checking-for-multicolinearity"><span class="toc-section-number">8.4</span>  Checking for multicolinearity</a></li>
  <li><a href="#testing-for-spatial-autocorrelation" id="toc-testing-for-spatial-autocorrelation" class="nav-link" data-scroll-target="#testing-for-spatial-autocorrelation"><span class="toc-section-number">8.5</span>  Testing for Spatial Autocorrelation</a>
  <ul class="collapse">
  <li><a href="#map-10" id="toc-map-10" class="nav-link" data-scroll-target="#map-10"><span class="toc-section-number">8.5.1</span>  Map</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#building-hedonic-pricing-models-using-gwmodel" id="toc-building-hedonic-pricing-models-using-gwmodel" class="nav-link" data-scroll-target="#building-hedonic-pricing-models-using-gwmodel"><span class="toc-section-number">9</span>  Building Hedonic Pricing Models using GWmodel</a>
  <ul class="collapse">
  <li><a href="#building-fixed-bandwidth-gwr-model" id="toc-building-fixed-bandwidth-gwr-model" class="nav-link" data-scroll-target="#building-fixed-bandwidth-gwr-model"><span class="toc-section-number">9.1</span>  Building Fixed Bandwidth GWR Model</a>
  <ul class="collapse">
  <li><a href="#computing-fixed-bandwith" id="toc-computing-fixed-bandwith" class="nav-link" data-scroll-target="#computing-fixed-bandwith"><span class="toc-section-number">9.1.1</span>  Computing fixed bandwith</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 18, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 26, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
.panel-tabset .nav-link {
  background-color: #a3d2e3;
  box-shadow: 8px 5px 5px darkgrey;
}

.panel-tabset .tab-content{
  box-shadow: 8px 5px 5px darkgrey;
}
</style>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Around 77.9% of dwellings in Singapore are made up of Housing and Development Board (HDB) flats, public housing many residents are familiar with and take pride in.</p>
<p>Though the number of households living in HDB apartments continues to increase, there is a steady fall in number of Singaporeans actually living in these flats. One <a href="https://www.straitstimes.com/singapore/singapore-resident-population-in-hdb-flats-falls-to-304m-with-smaller-households-spread">argument</a> provided is that more Singaporeans are selling their flats and “upgrading” to private housings, like condominium and private landed properties. Among those upgrading, selling their current house to afford for a better HDB apartments is not uncommon too.</p>
<p>On the flip side, there is the demand and there are many reasons for residents to buy resale flats.</p>
<ol type="1">
<li>Families may not be keen to wait approximately <a href="https://www.straitstimes.com/singapore/housing/how-are-bto-flats-built-and-why-do-waiting-times-vary-so-much">2 to 5.9 years</a> for an apartment under the Build-to-Order exercise.</li>
<li>Couples, being <a href="https://www.propertyguru.com.sg/property-guides/how-do-singapore-permanent-residents-buy-a-hdb-flat-9914">both Permanent Residents</a>, can only access the resale market, if they want to buy a HDB flat.</li>
<li><a href="https://www.hdb.gov.sg/residential/buying-a-flat/flat-and-grant-eligibility/singles">Single citizens</a> similarly are only allowed to purchase resale flats.</li>
</ol>
<p>In spite of the ever increasing resale prices, <a href="https://www.straitstimes.com/singapore/housing/hdb-resale-prices-rise-for-31st-straight-month-in-jan-sales-volume-rebounds-after-property-curbs#:~:text=Prices%20were%20up%208.7%20per,up%20by%205.4%20per%20cent.">increasing 8.7% YoY</a>, and much more expensive than a BTO flat, resale flats continue to be in the cards for residents to buy their dream homes.</p>
<p>With how expensive these apartments are, you better bet that people will be choosing where to place their money more carefully.</p>
</section>
<section id="import-packages" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Import Packages</h1>
<p>Below the packages that we will be using in this exercise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tmap, sfdep, tidyverse, olsrr, ggpubr, GWmodel, SpatialML, tidymodels, jsonlite, readxl, Rfast, corrplot, gtsummary, spdep) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Import Data</h1>
<table class="table">
<thead>
<tr class="header">
<th>Dataset</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>HDB Resale Flat Prices</td>
<td><a href="https://data.gov.sg/dataset/resale-flat-prices">Data.gov.sg</a></td>
</tr>
<tr class="even">
<td>Masterplan 2019 Subzone Boundary</td>
<td>Professor Kam Tin Seong</td>
</tr>
<tr class="odd">
<td>Hawker Centres</td>
<td><a href="https://www.onemap.gov.sg/main/v2/">OpenMapSG</a></td>
</tr>
<tr class="even">
<td>Elderly Centres</td>
<td><a href="https://www.onemap.gov.sg/main/v2/">OpenMapSG</a></td>
</tr>
<tr class="odd">
<td>Parks</td>
<td><a href="https://www.onemap.gov.sg/main/v2/">OpenMapSG</a></td>
</tr>
<tr class="even">
<td>Kindergartens</td>
<td><a href="https://www.onemap.gov.sg/main/v2/">OpenMapSG</a></td>
</tr>
<tr class="odd">
<td>Childcare Centres</td>
<td><a href="https://www.onemap.gov.sg/main/v2/">OpenMapSG</a></td>
</tr>
<tr class="even">
<td>Bus Stops</td>
<td><a href="https://datamall.lta.gov.sg/content/datamall/en/static-data.html">LTA DataMall</a></td>
</tr>
<tr class="odd">
<td>MRT Stations</td>
<td>LTA Data Mall</td>
</tr>
<tr class="even">
<td>Primary Schools</td>
<td><a href="https://www.onemap.gov.sg/main/v2/">OpenMapSG</a></td>
</tr>
<tr class="odd">
<td>Supermarkets</td>
<td><a href="https://www.onemap.gov.sg/main/v2/">OpenMapSG</a></td>
</tr>
<tr class="even">
<td>Malls</td>
<td><a href="https://en.wikipedia.org/wiki/List_of_shopping_malls_in_Singapore">Wikipedia</a></td>
</tr>
<tr class="odd">
<td>HDB MUP/HIP Status</td>
<td><a href="https://services2.hdb.gov.sg/webapp/BB33RESLSTATUS/BB33SEnquiry">Housing Development Board</a></td>
</tr>
</tbody>
</table>
<section id="import-hdb-resale-flat-prices" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="import-hdb-resale-flat-prices"><span class="header-section-number">3.1</span> Import HDB Resale Flat Prices</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>resale_prices <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">head</span>(resale_prices, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 11
  month   town     flat_…¹ block stree…² store…³ floor…⁴ flat_…⁵ lease…⁶ remai…⁷
  &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 2017-01 ANG MO … 2 ROOM  406   ANG MO… 10 TO …      44 Improv…    1979 61 yea…
2 2017-01 ANG MO … 3 ROOM  108   ANG MO… 01 TO …      67 New Ge…    1978 60 yea…
3 2017-01 ANG MO … 3 ROOM  602   ANG MO… 01 TO …      67 New Ge…    1980 62 yea…
4 2017-01 ANG MO … 3 ROOM  465   ANG MO… 04 TO …      68 New Ge…    1980 62 yea…
5 2017-01 ANG MO … 3 ROOM  601   ANG MO… 01 TO …      67 New Ge…    1980 62 yea…
# … with 1 more variable: resale_price &lt;dbl&gt;, and abbreviated variable names
#   ¹​flat_type, ²​street_name, ³​storey_range, ⁴​floor_area_sqm, ⁵​flat_model,
#   ⁶​lease_commence_date, ⁷​remaining_lease</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="convert-month-to-datatime-format" class="level4" data-number="3.1.0.1">
<h4 data-number="3.1.0.1" class="anchored" data-anchor-id="convert-month-to-datatime-format"><span class="header-section-number">3.1.0.1</span> Convert “Month” to DataTime Format</h4>
<p>As we want to have the abilities to filter the data according to its dates, it’s best for us to convert the <em>date</em> column to a DateTime format.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>resale_prices<span class="sc">$</span>date <span class="ot">&lt;-</span> zoo<span class="sc">::</span><span class="fu">as.Date</span>(zoo<span class="sc">::</span><span class="fu">as.yearmon</span>(resale_prices<span class="sc">$</span>month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">head</span>(resale_prices<span class="sc">$</span>date, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-01" "2017-01-01" "2017-01-01" "2017-01-01" "2017-01-01"</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="data---filter-jan-2021-to-feb-2023" class="level5" data-number="3.1.0.1.1">
<h5 data-number="3.1.0.1.1" class="anchored" data-anchor-id="data---filter-jan-2021-to-feb-2023"><span class="header-section-number">3.1.0.1.1</span> Data - Filter Jan 2021 to Feb 2023</h5>
<p>Here, we will filter the data so we will only be working with those from January 2021 to February 2023.</p>
<p>::: {.panel-tabset}</p>
</section>
<section id="code-2" class="level5" data-number="3.1.0.1.2">
<h5 data-number="3.1.0.1.2" class="anchored" data-anchor-id="code-2"><span class="header-section-number">3.1.0.1.2</span> Code</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>resale_prices_total <span class="ot">&lt;-</span> resale_prices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">'2021-01-01'</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">'2023-02-01'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-2" class="level5" data-number="3.1.0.1.3">
<h5 data-number="3.1.0.1.3" class="anchored" data-anchor-id="data-2"><span class="header-section-number">3.1.0.1.3</span> Data</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">head</span>(resale_prices_total, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 12
  month   town     flat_…¹ block stree…² store…³ floor…⁴ flat_…⁵ lease…⁶ remai…⁷
  &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 2021-01 ANG MO … 2 ROOM  170   ANG MO… 01 TO …      45 Improv…    1986 64 yea…
2 2021-01 ANG MO … 2 ROOM  170   ANG MO… 07 TO …      45 Improv…    1986 64 yea…
3 2021-01 ANG MO … 3 ROOM  331   ANG MO… 04 TO …      68 New Ge…    1981 59 yea…
4 2021-01 ANG MO … 3 ROOM  534   ANG MO… 04 TO …      68 New Ge…    1980 58 yea…
5 2021-01 ANG MO … 3 ROOM  561   ANG MO… 01 TO …      68 New Ge…    1980 58 yea…
# … with 2 more variables: resale_price &lt;dbl&gt;, date &lt;date&gt;, and abbreviated
#   variable names ¹​flat_type, ²​street_name, ³​storey_range, ⁴​floor_area_sqm,
#   ⁵​flat_model, ⁶​lease_commence_date, ⁷​remaining_lease</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="import-subzone-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="import-subzone-data"><span class="header-section-number">3.2</span> Import Subzone Data</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>subzone_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/MPSZ-2019"</span>, <span class="at">layer=</span><span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\MPSZ-2019' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">head</span>(subzone_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 8012.578 ymin: 22108.68 xmax: 35287.9 ymax: 31092.38
Projected CRS: SVY21 / Singapore TM
                SUBZONE_N SUBZONE_C      PLN_AREA_N PLN_AREA_C       REGION_N
1             MARINA EAST    MESZ01     MARINA EAST         ME CENTRAL REGION
2        INSTITUTION HILL    RVSZ05    RIVER VALLEY         RV CENTRAL REGION
3          ROBERTSON QUAY    SRSZ01 SINGAPORE RIVER         SR CENTRAL REGION
4 JURONG ISLAND AND BUKOM    WISZ01 WESTERN ISLANDS         WI    WEST REGION
5            FORT CANNING    MUSZ02          MUSEUM         MU CENTRAL REGION
6        MARINA EAST (MP)    MPSZ05   MARINE PARADE         MP CENTRAL REGION
  REGION_C                       geometry
1       CR MULTIPOLYGON (((33222.98 29...
2       CR MULTIPOLYGON (((28481.45 30...
3       CR MULTIPOLYGON (((28087.34 30...
4       WR MULTIPOLYGON (((14557.7 304...
5       CR MULTIPOLYGON (((29542.53 31...
6       CR MULTIPOLYGON (((35279.55 30...</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="import-independent-variables" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="import-independent-variables"><span class="header-section-number">3.3</span> Import Independent Variables</h2>
<p>With any creation of a predictive model, comes the independent variables that the predictions will rely on.</p>
<section id="geospatial-datasets" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="geospatial-datasets"><span class="header-section-number">3.3.1</span> Geospatial Datasets</h3>
<p>Since this project is pertain to Singapore, OpenMapSG will be helpful for us to get these geospatial datasets with ease.</p>
<p>As you can see below, we will be using a package called <em>onemapsgapi</em> that wraps OpenMapSG API.</p>
<p>Using it is relatively simple:</p>
<ol type="1">
<li>One will need to register an account with OpenMapSG</li>
<li>Get a token using <code>get_token()</code></li>
<li>Search for datasets they want in <code>search_themes()</code></li>
<li>Optionally, look up on the status on desired dataset through <code>get_theme_status()</code></li>
<li>And finally get your data from <code>get_theme()</code>!</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">library</span>(onemapsgapi)</span>
<span id="cb15-2"><a href="#cb15-2"></a>token <span class="ot">&lt;-</span> <span class="fu">get_token</span>(<span class="st">"Your Email"</span>, <span class="st">"Your Password"</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">search_themes</span>(token, <span class="st">"searchval"</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">get_theme_status</span>(token, <span class="st">"themename"</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>themetibble <span class="ot">&lt;-</span> <span class="fu">get_theme</span>(token, <span class="st">"themename"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I will have already performed the above steps to acquire my datasets. In our case, I will directly read the geospatial data I have downloaded using <code>st_read()</code>.</p>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Hawker Centres</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Eldercare Centres</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Parks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Kindergartens</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Childcare Centres</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">Bus Stop</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-7" role="tab" aria-controls="tabset-4-7" aria-selected="false">MRT Stations</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>hawkercentre_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/hawkercentre"</span>, <span class="at">layer=</span><span class="st">"hawkercentre"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `hawkercentre' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\hawkercentre' 
  using driver `ESRI Shapefile'
Simple feature collection with 125 features and 18 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6974 ymin: 1.272716 xmax: 103.9882 ymax: 1.449017
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>eldercare_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/eldercare"</span>, <span class="at">layer=</span><span class="st">"eldercare"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `eldercare' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\eldercare' 
  using driver `ESRI Shapefile'
Simple feature collection with 133 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.7119 ymin: 1.271472 xmax: 103.9561 ymax: 1.439561
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>parks_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/nationalparks"</span>, <span class="at">layer=</span><span class="st">"nationalparks"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `nationalparks' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\nationalparks' 
  using driver `ESRI Shapefile'
Simple feature collection with 421 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6929 ymin: 1.214491 xmax: 104.0538 ymax: 1.462094
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>kindergartens_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/kindergartens"</span>, <span class="at">layer=</span><span class="st">"kindergartens"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `kindergartens' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\kindergartens' 
  using driver `ESRI Shapefile'
Simple feature collection with 448 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6887 ymin: 1.247759 xmax: 103.9717 ymax: 1.455452
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>childcare_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/childcare"</span>, <span class="at">layer=</span><span class="st">"childcare"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `childcare' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\childcare' 
  using driver `ESRI Shapefile'
Simple feature collection with 1925 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>busstop_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/BusStop_Feb2023"</span>, <span class="at">layer=</span><span class="st">"BusStop"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\BusStop_Feb2023' 
  using driver `ESRI Shapefile'
Simple feature collection with 5159 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
</div>
<div id="tabset-4-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>mrt_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/TrainStation_Feb2023"</span>, <span class="at">layer=</span><span class="st">"RapidTransitSystemStation"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `RapidTransitSystemStation' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\TrainStation_Feb2023' 
  using driver `ESRI Shapefile'
Simple feature collection with 220 features and 4 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58
Projected CRS: SVY21</code></pre>
</div>
</div>
<section id="supermarkets" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="supermarkets"><span class="header-section-number">3.3.2</span> Supermarkets</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>supermarkets_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/supermarkets"</span>, <span class="at">layer=</span><span class="st">"SUPERMARKETS"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `SUPERMARKETS' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\supermarkets' 
  using driver `ESRI Shapefile'
Simple feature collection with 526 features and 8 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4901.188 ymin: 25529.08 xmax: 46948.22 ymax: 49233.6
Projected CRS: SVY21</code></pre>
</div>
</div>
</section>
<section id="malls" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="malls"><span class="header-section-number">3.3.3</span> Malls</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>malls <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/aspatial/malls-20230320.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mup" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="mup"><span class="header-section-number">3.3.4</span> MUP</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>hdb_upgrades <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/aspatial/HDB_HIP-MUP-20230312.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</div>
</div>
</section>
<section id="aspatial-data" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="aspatial-data"><span class="header-section-number">3.3.5</span> Aspatial Data</h3>
<section id="primary-schools-and-ranking" class="level4" data-number="3.3.5.1">
<h4 data-number="3.3.5.1" class="anchored" data-anchor-id="primary-schools-and-ranking"><span class="header-section-number">3.3.5.1</span> Primary Schools and Ranking</h4>
<p>there are 181 schools so when merged, some rows disappeared</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>primarySch <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/geospatial/primaryschools/primaryschools.json"</span>)[[<span class="st">"SearchResults"</span>]][<span class="sc">-</span><span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">14</span>)]</span>
<span id="cb34-2"><a href="#cb34-2"></a>primarySch_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(primarySch, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co"># primarySch_sf$SCHOOLNAME &lt;- str_to_title(primarySch_sf$SCHOOLNAME) # for merging purpose</span></span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a>primarySch_ranking <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/geospatial/primaryschools/primaryschools_rankings.json"</span>)[[<span class="st">"props"</span>]][[<span class="st">"pageProps"</span>]][[<span class="st">"sortedSchools"</span>]]</span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a>primarySch_ranking <span class="ot">=</span> <span class="fu">unnest</span>(primarySch_ranking, schoolInfo)[,<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">22</span>, <span class="dv">28</span><span class="sc">:</span><span class="dv">32</span>)] <span class="co"># to expand schoolinfo df</span></span>
<span id="cb34-9"><a href="#cb34-9"></a></span>
<span id="cb34-10"><a href="#cb34-10"></a>primarySch_ranking_sf <span class="ot">=</span> <span class="fu">merge</span>(primarySch_ranking, primarySch_sf, <span class="at">by.x=</span><span class="st">'postalCode'</span>, <span class="at">by.y=</span><span class="st">"SCH_POSTAL_CODE"</span>)</span>
<span id="cb34-11"><a href="#cb34-11"></a></span>
<span id="cb34-12"><a href="#cb34-12"></a>primarySch__order_ranking_sf <span class="ot">=</span> primarySch_ranking_sf[<span class="fu">order</span>(primarySch_ranking_sf<span class="sc">$</span>rank),]</span>
<span id="cb34-13"><a href="#cb34-13"></a></span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="co"># sch dont exist in final dataframe</span></span>
<span id="cb34-15"><a href="#cb34-15"></a>schools_dont_exist <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(primarySch_ranking)){</span>
<span id="cb34-17"><a href="#cb34-17"></a>  <span class="cf">if</span> (i <span class="sc">%in%</span> primarySch__order_ranking_sf<span class="sc">$</span>rank <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb34-18"><a href="#cb34-18"></a>    schools_dont_exist <span class="ot">&lt;-</span> <span class="fu">append</span>(schools_dont_exist, i)</span>
<span id="cb34-19"><a href="#cb34-19"></a>  }</span>
<span id="cb34-20"><a href="#cb34-20"></a>}</span>
<span id="cb34-21"><a href="#cb34-21"></a></span>
<span id="cb34-22"><a href="#cb34-22"></a>schools <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb34-23"><a href="#cb34-23"></a></span>
<span id="cb34-24"><a href="#cb34-24"></a><span class="cf">for</span> (sch <span class="cf">in</span> schools_dont_exist){</span>
<span id="cb34-25"><a href="#cb34-25"></a>  schools <span class="ot">=</span> <span class="fu">rbind</span>(schools, primarySch_ranking[primarySch_ranking<span class="sc">$</span>rank <span class="sc">==</span> sch,])</span>
<span id="cb34-26"><a href="#cb34-26"></a>}</span>
<span id="cb34-27"><a href="#cb34-27"></a>schools</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
   rank school…¹ schoo…² address schoo…³ posta…⁴ schoo…⁵ affil…⁶ admis…⁷ sport…⁸
  &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;list&gt;  &lt;list&gt;    &lt;int&gt;   &lt;int&gt;
1   116 Pioneer… West    23 Jur… Jurong… 649076  &lt;chr&gt;   &lt;chr&gt;       132     103
2   119 Stamfor… South   1 Vict… Central 198423  &lt;chr&gt;   &lt;chr&gt;       132      42
3   134 Eunos P… East    95 Jal… Geylang 419529  &lt;chr&gt;   &lt;chr&gt;       132      88
4   137 Guangya… South   6 Bish… Bishan  579806  &lt;chr&gt;   &lt;chr&gt;       132     145
5   165 Juying … West    31 Jur… Jurong… 649037  &lt;chr&gt;   &lt;chr&gt;       132     116
6   171 Angsana… East    3 Tamp… Tampin… 529366  &lt;chr&gt;   &lt;chr&gt;       132     150
# … with 2 more variables: artsRank &lt;int&gt;, uniformedGroupsRank &lt;int&gt;, and
#   abbreviated variable names ¹​schoolName, ²​schoolZone, ³​schoolArea,
#   ⁴​postalCode, ⁵​schoolStatus, ⁶​affiliatedSchools, ⁷​admissionRank, ⁸​sportsRank</code></pre>
</div>
</div>
<p>Pioneer Primary School merged in Juying Primary School in 2021 and not opening from Primary 1 (P1) through the P1 Registration from 2021 to 2024 due to moving to Tengah instead Stamford Primary School merges with Farrer Park Primary School in 2023 Eunos Primary School which is closed and merged with Telok Kurau Primary merging of our school with Guangyang Primary School/Townsville Primary School</p>
<p>angsana primary schoolis postal code is wrong</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>primarySch_sf[primarySch_sf<span class="sc">$</span>SCHOOLNAME <span class="sc">==</span> <span class="fu">toupper</span>(<span class="st">"Angsana Primary School"</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 39752.22 ymin: 38402.06 xmax: 39752.22 ymax: 38402.06
Projected CRS: SVY21 / Singapore TM
               SCHOOLNAME SCH_HSE_BLK_NUM HSE_BLK_NUM SCH_POSTAL_CODE
11 ANGSANA PRIMARY SCHOOL              51          51          528565
        SCH_ROAD_NAME                  geometry
11 TAMPINES STREET 61 POINT (39752.22 38402.06)</code></pre>
</div>
</div>
<p>checking website, angsana primary schoolis postal code is 528565. so we need to change primarySch_ranking’s postal code to facilitate merging.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>primarySch_ranking[primarySch_ranking<span class="sc">$</span>schoolName <span class="sc">==</span> <span class="st">"Angsana Primary School"</span>,<span class="st">"postalCode"</span>] <span class="ot">=</span> <span class="st">'528565'</span></span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>primarySch_ranking_df <span class="ot">=</span> <span class="fu">merge</span>(primarySch_ranking, primarySch_sf, <span class="at">by.x=</span><span class="st">'postalCode'</span>, <span class="at">by.y=</span><span class="st">"SCH_POSTAL_CODE"</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="fu">nrow</span>(primarySch_ranking_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 181</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>primarySch_ranking_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(primarySch_ranking_df) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="data-wrangling" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data Wrangling</h1>
<section id="central-business-district" class="level3" data-number="4.0.1">
<h3 data-number="4.0.1" class="anchored" data-anchor-id="central-business-district"><span class="header-section-number">4.0.1</span> Central Business District</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>cbd_sf <span class="ot">&lt;-</span> subzone_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(subzone_sf<span class="sc">$</span>PLN_AREA_N <span class="sc">==</span> <span class="st">"DOWNTOWN CORE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mpsz" class="level2 panel-set" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="mpsz"><span class="header-section-number">4.1</span> MPSZ</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(subzone_sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>subzone_sf <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(subzone_sf)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(subzone_sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="mrt" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="mrt"><span class="header-section-number">4.2</span> MRT</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mrt_sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>mrt_sf[<span class="fu">st_is_valid</span>(mrt_sf) <span class="sc">==</span> <span class="cn">FALSE</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3 features and 4 fields (with 1 geometry empty)
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 26568.45 ymin: 27478.44 xmax: 28080.89 ymax: 37543.25
Projected CRS: SVY21 / Singapore TM
    TYP_CD STN_NAM TYP_CD_DES                STN_NAM_DE
159      0    &lt;NA&gt;        MRT  HARBOURFRONT MRT STATION
NA      NA    &lt;NA&gt;       &lt;NA&gt;                      &lt;NA&gt;
218      0    &lt;NA&gt;        MRT UPPER THOMSON MRT STATION
                          geometry
159 POLYGON ((26736.44 27495.44...
NA                   POLYGON EMPTY
218 POLYGON ((27808.12 37518.2,...</code></pre>
</div>
</div>
<p>cannot fix using st_make_valid so</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>mrt_sf <span class="ot">&lt;-</span> mrt_sf[<span class="fu">st_is_valid</span>(mrt_sf) <span class="sc">==</span> <span class="cn">TRUE</span>,]</span>
<span id="cb50-2"><a href="#cb50-2"></a>mrt_sf <span class="ot">&lt;-</span> mrt_sf[<span class="sc">!</span><span class="fu">st_is_empty</span>(mrt_sf),,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mrt_sf) <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="get-coordinates-for-hdb" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="get-coordinates-for-hdb"><span class="header-section-number">4.3</span> Get Coordinates for HDB</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb52-2"><a href="#cb52-2"></a>geocode <span class="ot">&lt;-</span> <span class="cf">function</span>(block, <span class="at">streetname=</span><span class="st">""</span>) {</span>
<span id="cb52-3"><a href="#cb52-3"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://developers.onemap.sg/commonapi/search"</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>  address <span class="ot">&lt;-</span> <span class="fu">paste</span>(block, streetname, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"searchVal"</span> <span class="ot">=</span> address, </span>
<span id="cb52-6"><a href="#cb52-6"></a>                <span class="st">"returnGeom"</span> <span class="ot">=</span> <span class="st">"Y"</span>,</span>
<span id="cb52-7"><a href="#cb52-7"></a>                <span class="st">"getAddrDetails"</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb52-8"><a href="#cb52-8"></a>                <span class="st">"pageNum"</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb52-9"><a href="#cb52-9"></a>  </span>
<span id="cb52-10"><a href="#cb52-10"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb52-11"><a href="#cb52-11"></a>  restext<span class="ot">&lt;-</span><span class="fu">content</span>(res, <span class="at">as=</span><span class="st">"text"</span>)</span>
<span id="cb52-12"><a href="#cb52-12"></a>  </span>
<span id="cb52-13"><a href="#cb52-13"></a>  output <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(restext)  <span class="sc">%&gt;%</span> </span>
<span id="cb52-14"><a href="#cb52-14"></a>    as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="#cb52-15"></a>    <span class="fu">select</span>(results.LATITUDE, results.LONGITUDE)</span>
<span id="cb52-16"><a href="#cb52-16"></a></span>
<span id="cb52-17"><a href="#cb52-17"></a>  <span class="fu">return</span>(output)</span>
<span id="cb52-18"><a href="#cb52-18"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>resale_prices_total<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>resale_prices_total<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-3"><a href="#cb53-3"></a></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resale_prices_total)){</span>
<span id="cb53-5"><a href="#cb53-5"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(resale_prices_total[i, <span class="dv">4</span>], resale_prices_total[i, <span class="dv">5</span>])</span>
<span id="cb53-6"><a href="#cb53-6"></a>  </span>
<span id="cb53-7"><a href="#cb53-7"></a>  resale_prices_total<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb53-8"><a href="#cb53-8"></a>  resale_prices_total<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb53-9"><a href="#cb53-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>resale_prices_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(resale_prices_total, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="fu">st_write</span>(resale_prices_sf, <span class="st">"data/geospatial/resale_prices/resale_prices.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>resale_prices_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/resale_prices"</span>, <span class="at">layer=</span><span class="st">"resale_prices"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `resale_prices' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\resale_prices' 
  using driver `ESRI Shapefile'
Simple feature collection with 60218 features and 12 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6442 ymin: 1.27038 xmax: 103.9878 ymax: 1.457071
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<section id="merge-with-hdb-status" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="merge-with-hdb-status"><span class="header-section-number">4.3.1</span> Merge with HDB Status</h3>
<section id="hip" class="level4" data-number="4.3.1.1">
<h4 data-number="4.3.1.1" class="anchored" data-anchor-id="hip"><span class="header-section-number">4.3.1.1</span> HIP</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>hdb_hip <span class="ot">&lt;-</span> hdb_upgrades <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TYPE <span class="sc">==</span> <span class="st">"HIP"</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="fu">colnames</span>(hdb_hip)[<span class="dv">3</span>] <span class="ot">=</span><span class="st">"HIP"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>resale_prices_upgrade_sf <span class="ot">&lt;-</span> <span class="fu">merge</span>(resale_prices_sf, hdb_hip, <span class="at">by.x=</span><span class="fu">c</span>(<span class="st">"block"</span>, <span class="st">"strt_nm"</span>), <span class="at">by.y=</span><span class="fu">c</span>(<span class="st">"BLK"</span>, <span class="st">"STREET"</span>), <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mup-1" class="level4" data-number="4.3.1.2">
<h4 data-number="4.3.1.2" class="anchored" data-anchor-id="mup-1"><span class="header-section-number">4.3.1.2</span> MUP</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>hdb_mup <span class="ot">&lt;-</span> hdb_upgrades <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TYPE <span class="sc">==</span> <span class="st">"MUP"</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="fu">colnames</span>(hdb_mup)[<span class="dv">3</span>] <span class="ot">=</span><span class="st">"MUP"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>resale_prices_upgrade_sf <span class="ot">&lt;-</span> <span class="fu">merge</span>(resale_prices_upgrade_sf, hdb_mup, <span class="at">by.x=</span><span class="fu">c</span>(<span class="st">"block"</span>, <span class="st">"strt_nm"</span>), <span class="at">by.y=</span><span class="fu">c</span>(<span class="st">"BLK"</span>, <span class="st">"STREET"</span>), <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="malls-1" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="malls-1"><span class="header-section-number">4.4</span> Malls</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>malls<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>malls<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb61-3"><a href="#cb61-3"></a></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(malls)){</span>
<span id="cb61-5"><a href="#cb61-5"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(malls[i, <span class="dv">1</span>], )</span>
<span id="cb61-6"><a href="#cb61-6"></a>  </span>
<span id="cb61-7"><a href="#cb61-7"></a>  malls<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb61-8"><a href="#cb61-8"></a>  malls<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb61-9"><a href="#cb61-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>malls_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(malls, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="fu">st_write</span>(malls_sf, <span class="st">"data/geospatial/malls/malls.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>malls_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/malls"</span>, <span class="at">layer=</span><span class="st">"malls"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `malls' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\malls' 
  using driver `ESRI Shapefile'
Simple feature collection with 167 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 103.6784 ymin: 1.263932 xmax: 103.9895 ymax: 1.448194
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</section>
<section id="top-20-primary-schools" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="top-20-primary-schools"><span class="header-section-number">4.5</span> Top 20 Primary Schools</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>top_primarySch_ranking_sf <span class="ot">&lt;-</span> primarySch_ranking_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="acquire-proximity" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Acquire Proximity</h1>
<p>Function to acquire proximity</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>proximity_calculator <span class="ot">&lt;-</span> <span class="cf">function</span>(original_sf, derived_sf, column_name) {</span>
<span id="cb66-2"><a href="#cb66-2"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(original_sf, derived_sf)</span>
<span id="cb66-3"><a href="#cb66-3"></a>  original_sf[, column_name] <span class="ot">&lt;-</span> <span class="fu">rowMins</span>(dist_matrix) <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="fu">return</span>(original_sf)</span>
<span id="cb66-5"><a href="#cb66-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>resale_proximity_sf <span class="ot">&lt;-</span> resale_prices_upgrade_sf </span>
<span id="cb67-2"><a href="#cb67-2"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> cbd_sf, <span class="at">column_name =</span> <span class="st">"PROX_CBD"</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> hawkercentre_sf, <span class="at">column_name=</span><span class="st">"PROX_HAWKER"</span>)</span>
<span id="cb67-4"><a href="#cb67-4"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> eldercare_sf, <span class="at">column_name =</span> <span class="st">"PROX_ELDERCARE"</span>)</span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> parks_sf, <span class="at">column_name=</span><span class="st">"PROX_PARK"</span>)</span>
<span id="cb67-6"><a href="#cb67-6"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> kindergartens_sf, <span class="at">column_name =</span> <span class="st">"PROX_KINDERGARTEN"</span>)</span>
<span id="cb67-7"><a href="#cb67-7"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> childcare_sf, <span class="at">column_name =</span> <span class="st">"PROX_CHILDCARE"</span>)</span>
<span id="cb67-8"><a href="#cb67-8"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> busstop_sf, <span class="at">column_name =</span> <span class="st">"PROX_BUSSTOP"</span>)</span>
<span id="cb67-9"><a href="#cb67-9"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> mrt_sf, <span class="at">column_name =</span> <span class="st">"PROX_MRT"</span>)</span>
<span id="cb67-10"><a href="#cb67-10"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> primarySch_ranking_sf, <span class="at">column_name =</span> <span class="st">"PROX_SCH"</span>)</span>
<span id="cb67-11"><a href="#cb67-11"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> supermarkets_sf, <span class="at">column_name=</span><span class="st">"PROX_SUPERMARKET"</span>)</span>
<span id="cb67-12"><a href="#cb67-12"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> malls_sf, <span class="at">column_name =</span> <span class="st">"PROX_MALL"</span>)</span>
<span id="cb67-13"><a href="#cb67-13"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">proximity_calculator</span>(<span class="at">original_sf =</span> resale_proximity_sf, <span class="at">derived_sf =</span> top_primarySch_ranking_sf, <span class="at">column_name =</span> <span class="st">"PROX_TOPSCH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="within-radius" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="within-radius"><span class="header-section-number">5.1</span> Within radius</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">library</span>(units)</span>
<span id="cb68-2"><a href="#cb68-2"></a>radius_calculator <span class="ot">&lt;-</span> <span class="cf">function</span>(original_sf, derived_sf, column_name, radius) {</span>
<span id="cb68-3"><a href="#cb68-3"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(original_sf, derived_sf) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4"></a>    <span class="fu">drop_units</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb68-6"><a href="#cb68-6"></a>  original_sf[,column_name] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dist_matrix <span class="sc">&lt;=</span> radius)</span>
<span id="cb68-7"><a href="#cb68-7"></a>  <span class="fu">return</span>(original_sf)</span>
<span id="cb68-8"><a href="#cb68-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">radius_calculator</span>(resale_proximity_sf, kindergartens_sf, <span class="st">"NUM_KINDERGARTEN"</span>, <span class="dv">350</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">radius_calculator</span>(resale_proximity_sf, childcare_sf, <span class="st">"NUM_CHILDCARE"</span>, <span class="dv">350</span>)</span>
<span id="cb69-3"><a href="#cb69-3"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">radius_calculator</span>(resale_proximity_sf, busstop_sf, <span class="st">"NUM_BUSSTOP"</span>, <span class="dv">350</span>)</span>
<span id="cb69-4"><a href="#cb69-4"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">radius_calculator</span>(resale_proximity_sf, primarySch_ranking_sf, <span class="st">"NUM_SCH"</span>, <span class="dv">1000</span>)</span>
<span id="cb69-5"><a href="#cb69-5"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">radius_calculator</span>(resale_proximity_sf, top_primarySch_ranking_sf, <span class="st">"NUM_TOPSCH"</span>, <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">st_write</span>(resale_proximity_sf, <span class="st">"data/geospatial/resale_proximity/resale_proximity.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/resale_proximity"</span>, <span class="at">layer=</span><span class="st">"resale_proximity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `resale_proximity' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\resale_proximity' 
  using driver `ESRI Shapefile'
Simple feature collection with 60218 features and 32 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6958.193 ymin: 28097.64 xmax: 45192.3 ymax: 48741.06
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</section>
</section>
<section id="get-proximity-locational-factors" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Get Proximity Locational Factors</h1>
<section id="floor-level" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="floor-level"><span class="header-section-number">6.1</span> Floor Level</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>storey_category <span class="ot">&lt;-</span> <span class="fu">unique</span>(resale_proximity_sf<span class="sc">$</span>stry_rn)</span>
<span id="cb73-2"><a href="#cb73-2"></a>storey_category</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "07 TO 09" "16 TO 18" "01 TO 03" "13 TO 15" "10 TO 12" "04 TO 06"
 [7] "19 TO 21" "22 TO 24" "25 TO 27" "34 TO 36" "31 TO 33" "37 TO 39"
[13] "40 TO 42" "28 TO 30" "43 TO 45" "49 TO 51" "46 TO 48"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>storey_names <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(storey_category)</span>
<span id="cb75-2"><a href="#cb75-2"></a>storey_order <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(storey_category, storey_names)</span>
<span id="cb75-3"><a href="#cb75-3"></a>storey_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   storey_category storey_names
1         07 TO 09            1
2         16 TO 18            2
3         01 TO 03            3
4         13 TO 15            4
5         10 TO 12            5
6         04 TO 06            6
7         19 TO 21            7
8         22 TO 24            8
9         25 TO 27            9
10        34 TO 36           10
11        31 TO 33           11
12        37 TO 39           12
13        40 TO 42           13
14        28 TO 30           14
15        43 TO 45           15
16        49 TO 51           16
17        46 TO 48           17</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>resale_level_loc_sf <span class="ot">&lt;-</span> <span class="fu">merge</span>(resale_proximity_sf, storey_order, <span class="at">by.x =</span> <span class="st">"stry_rn"</span>, <span class="at">by.y =</span> <span class="st">"storey_category"</span>, <span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a>resale_level_loc_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 60218 features and 33 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6958.193 ymin: 28097.64 xmax: 45192.3 ymax: 48741.06
Projected CRS: SVY21 / Singapore TM
First 10 features:
    stry_rn block          strt_nm   month            town   flt_typ flr_r_s
1  01 TO 03  117B     JLN TENTERAM 2021-08 KALLANG/WHAMPOA    4 ROOM      93
2  01 TO 03  101A  LOR 2 TOA PAYOH 2021-10       TOA PAYOH EXECUTIVE     145
3  01 TO 03    57  LOR 5 TOA PAYOH 2021-08       TOA PAYOH    3 ROOM      61
4  01 TO 03  305A  ANCHORVALE LINK 2021-06        SENGKANG    5 ROOM     110
5  01 TO 03   237    HOUGANG ST 21 2022-05         HOUGANG EXECUTIVE     148
6  01 TO 03   538 ANG MO KIO AVE 5 2023-02      ANG MO KIO    3 ROOM      68
7  01 TO 03   358   CLEMENTI AVE 2 2021-07        CLEMENTI    4 ROOM      92
8  01 TO 03   461         SEGAR RD 2021-02   BUKIT PANJANG    4 ROOM      93
9  01 TO 03  424D    YISHUN AVE 11 2022-11          YISHUN    3 ROOM      67
10 01 TO 03   401   HOUGANG AVE 10 2021-07         HOUGANG    3 ROOM      68
             flt_mdl ls_cmm_            rmnng_l rsl_prc       date  HIP
1            Model A    2017 95 years 03 months  655000 2021-08-01 &lt;NA&gt;
2          Apartment    1993 70 years 07 months  898000 2021-10-01 &lt;NA&gt;
3           Standard    1973 50 years 06 months  260000 2021-08-01 &lt;NA&gt;
4           Improved    2002 79 years 09 months  445000 2021-06-01 &lt;NA&gt;
5         Maisonette    1984 61 years 03 months  760000 2022-05-01 &lt;NA&gt;
6     New Generation    1980 56 years 02 months  358000 2023-02-01  HIP
7     New Generation    1978 55 years 07 months  422000 2021-07-01  HIP
8  Premium Apartment    2015 93 years 07 months  390000 2021-02-01 &lt;NA&gt;
9            Model A    2015 92 years 03 months  360000 2022-11-01 &lt;NA&gt;
10    New Generation    1985 62 years 11 months  325000 2021-07-01  HIP
       TOWN_x  MUP    TOWN_y PROX_CB PROX_HA PROX_EL PROX_KI PROX_CH PROX_BU
1        &lt;NA&gt; &lt;NA&gt;      &lt;NA&gt;   0.013   0.122   0.115   0.371   0.799   2.842
2        &lt;NA&gt; &lt;NA&gt;      &lt;NA&gt;   0.012   0.114   0.033   0.422   1.905   2.629
3        &lt;NA&gt;  MUP TOA PAYOH   0.012   0.115   0.033   0.423   0.902   0.934
4        &lt;NA&gt; &lt;NA&gt;      &lt;NA&gt;   0.013   0.008   0.066   0.272   1.102   0.465
5        &lt;NA&gt; &lt;NA&gt;      &lt;NA&gt;   0.013   0.079   0.042   0.113   1.366   4.606
6  ANG MO KIO &lt;NA&gt;      &lt;NA&gt;   0.013   0.020   0.013   0.002   1.797   0.824
7    CLEMENTI &lt;NA&gt;      &lt;NA&gt;   0.003   0.047   0.103   0.007   0.937   1.001
8        &lt;NA&gt; &lt;NA&gt;      &lt;NA&gt;   0.012   0.038   0.045   0.255   1.691   0.739
9        &lt;NA&gt; &lt;NA&gt;      &lt;NA&gt;   0.013   0.124   0.072   0.049   0.891   2.761
10    HOUGANG &lt;NA&gt;      &lt;NA&gt;   0.013   0.008   0.095   0.107   1.587   2.062
   PROX_MR PROX_SC PROX_SU PROX_MA PROX_TO NUM_KIN NUM_CHI NUM_BUS NUM_SCH
1    0.075   0.033   0.074   0.057   0.007       0       1       6       3
2    0.037   0.028   0.232   0.019   0.007       2       4      10       5
3    0.037   0.028   0.232   0.019   0.007       1       5      11       3
4    0.129   0.082   0.433   0.114   0.015       0       4       8       4
5    0.156   0.079   0.317   0.116   0.014       1       4       8       2
6    0.056   0.094   0.040   0.098   0.016       1       3      10       1
7    0.044   0.007   0.159   0.161   0.001       1       3       9       2
8    0.077   0.127   0.330   0.131   0.019       2       8       6       4
9    0.086   0.165   0.502   0.106   0.016       0       2       6       3
10   0.008   0.072   0.252   0.111   0.014       3       6       9       5
   NUM_TOP storey_names                  geometry
1        0            3 POINT (31058.62 34487.27)
2        1            3     POINT (29552 35767.3)
3        1            3 POINT (30022.91 35470.15)
4        0            3 POINT (34103.93 41148.01)
5        0            3 POINT (34180.87 37633.89)
6        0            3    POINT (30229 39731.65)
7        0            3 POINT (20851.34 32875.25)
8        0            3 POINT (21095.91 40990.18)
9        0            3  POINT (29769.97 44954.8)
10       1            3 POINT (35086.31 39648.81)</code></pre>
</div>
</div>
</section>
<section id="remaining-lease" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="remaining-lease"><span class="header-section-number">6.2</span> Remaining Lease</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>str_list <span class="ot">&lt;-</span> <span class="fu">str_split</span>(resale_level_loc_sf<span class="sc">$</span>rmnng_l, <span class="st">" "</span>)</span>
<span id="cb79-2"><a href="#cb79-2"></a></span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(str_list)) {</span>
<span id="cb79-4"><a href="#cb79-4"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unlist</span>(str_list[i])) <span class="sc">&gt;</span> <span class="dv">2</span>) {</span>
<span id="cb79-5"><a href="#cb79-5"></a>      year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb79-6"><a href="#cb79-6"></a>      month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">3</span>])</span>
<span id="cb79-7"><a href="#cb79-7"></a>      resale_level_loc_sf[i, <span class="st">"remaining_lease"</span>] <span class="ot">&lt;-</span> (year <span class="sc">*</span> <span class="dv">12</span>) <span class="sc">+</span> month</span>
<span id="cb79-8"><a href="#cb79-8"></a>  }</span>
<span id="cb79-9"><a href="#cb79-9"></a>  <span class="cf">else</span> {</span>
<span id="cb79-10"><a href="#cb79-10"></a>    year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb79-11"><a href="#cb79-11"></a>    resale_level_loc_sf[i, <span class="st">"remaining_lease"</span>] <span class="ot">&lt;-</span> (year <span class="sc">*</span> <span class="dv">12</span>)</span>
<span id="cb79-12"><a href="#cb79-12"></a>  }</span>
<span id="cb79-13"><a href="#cb79-13"></a>}</span>
<span id="cb79-14"><a href="#cb79-14"></a>resale_remaining_lease_loc_sf <span class="ot">&lt;-</span> resale_level_loc_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">st_write</span>(resale_remaining_lease_loc_sf, <span class="st">"data/geospatial/resale_proximity/resale_proximity.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>resale_remaining_lease_loc_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/resale_proximity"</span>, <span class="at">layer=</span><span class="st">"resale_proximity"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `resale_proximity' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\resale_proximity' 
  using driver `ESRI Shapefile'
Simple feature collection with 60218 features and 32 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6958.193 ymin: 28097.64 xmax: 45192.3 ymax: 48741.06
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</section>
<section id="age-of-unit" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="age-of-unit"><span class="header-section-number">6.3</span> Age of Unit</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>resale_remaining_lease_loc_sf<span class="sc">$</span>year <span class="ot">&lt;-</span> zoo<span class="sc">::</span><span class="fu">as.Date</span>(zoo<span class="sc">::</span><span class="fu">as.yearmon</span>(resale_remaining_lease_loc_sf<span class="sc">$</span>ls_cmm_))</span>
<span id="cb83-2"><a href="#cb83-2"></a>resale_remaining_lease_loc_sf<span class="sc">$</span>age <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">interval</span>(resale_remaining_lease_loc_sf<span class="sc">$</span>year, resale_remaining_lease_loc_sf<span class="sc">$</span>date)<span class="sc">/</span> <span class="fu">years</span>(<span class="dv">1</span>))</span>
<span id="cb83-3"><a href="#cb83-3"></a>resale_age_loc_sf <span class="ot">&lt;-</span> resale_remaining_lease_loc_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="upgrades" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="upgrades"><span class="header-section-number">6.4</span> Upgrades</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>resale_upgrade_loc_sf <span class="ot">&lt;-</span> resale_age_loc_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>resale_upgrade_loc_sf<span class="sc">$</span>HIP <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(resale_upgrade_loc_sf<span class="sc">$</span>HIP), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a>resale_upgrade_loc_sf<span class="sc">$</span>MUP <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(resale_upgrade_loc_sf<span class="sc">$</span>MUP), <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">st_write</span>(resale_remaining_lease_loc_sf, <span class="st">"data/geospatial/resale_upgrade_loc_sf/resale_upgrade_loc_sf.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>resale_proximity_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial/resale_upgrade_loc_sf"</span>, <span class="at">layer=</span><span class="st">"resale_upgrade_loc_sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `resale_upgrade_loc_sf' from data source 
  `C:\deadline2359\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial\resale_upgrade_loc_sf' 
  using driver `ESRI Shapefile'
Simple feature collection with 60218 features and 32 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6958.193 ymin: 28097.64 xmax: 45192.3 ymax: 48741.06
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</section>
<section id="hdb-types" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="hdb-types"><span class="header-section-number">6.5</span> HDB Types</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>hdb_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(resale_upgrade_loc_sf<span class="sc">$</span>flt_typ)</span>
<span id="cb89-2"><a href="#cb89-2"></a>hdb_types</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "3 ROOM"           "5 ROOM"           "4 ROOM"           "EXECUTIVE"       
[5] "2 ROOM"           "MULTI-GENERATION" "1 ROOM"          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>resale_type_loc_sf <span class="ot">&lt;-</span> resale_upgrade_loc_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(resale_upgrade_loc_sf<span class="sc">$</span>flt_typ <span class="sc">==</span> <span class="st">"3 ROOM"</span>)</span>
<span id="cb91-2"><a href="#cb91-2"></a>resale_type_loc_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 13779 features and 34 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 11597.97 ymin: 28097.64 xmax: 45192.3 ymax: 48622.47
Projected CRS: SVY21 / Singapore TM
First 10 features:
   block         strt_nm   month            town flt_typ  stry_rn flr_r_s
1      1        BEACH RD 2021-02 KALLANG/WHAMPOA  3 ROOM 07 TO 09      68
2      1        BEACH RD 2021-03 KALLANG/WHAMPOA  3 ROOM 07 TO 09      68
3      1        BEACH RD 2021-07 KALLANG/WHAMPOA  3 ROOM 16 TO 18      68
4      1        BEACH RD 2022-12 KALLANG/WHAMPOA  3 ROOM 07 TO 09      68
5      1        BEACH RD 2022-07 KALLANG/WHAMPOA  3 ROOM 01 TO 03      68
6      1        BEACH RD 2021-04 KALLANG/WHAMPOA  3 ROOM 07 TO 09      68
7      1 BEDOK STH AVE 1 2021-01           BEDOK  3 ROOM 07 TO 09      59
8      1 BEDOK STH AVE 1 2021-04           BEDOK  3 ROOM 01 TO 03      59
9      1 BEDOK STH AVE 1 2021-05           BEDOK  3 ROOM 13 TO 15      59
10     1 BEDOK STH AVE 1 2021-09           BEDOK  3 ROOM 10 TO 12      67
    flt_mdl ls_cmm_            rmnng_l rsl_prc       date  HIP TOWN_x  MUP
1  Improved    1979 57 years 08 months  328000 2021-02-01 &lt;NA&gt;   &lt;NA&gt;  MUP
2  Improved    1979 57 years 07 months  350888 2021-03-01 &lt;NA&gt;   &lt;NA&gt;  MUP
3  Improved    1979 57 years 03 months  355000 2021-07-01 &lt;NA&gt;   &lt;NA&gt;  MUP
4  Improved    1979           56 years  418000 2022-12-01 &lt;NA&gt;   &lt;NA&gt;  MUP
5  Improved    1979 56 years 03 months  350000 2022-07-01 &lt;NA&gt;   &lt;NA&gt;  MUP
6  Improved    1979 57 years 05 months  328000 2021-04-01 &lt;NA&gt;   &lt;NA&gt;  MUP
7  Improved    1976  54 years 01 month  268000 2021-01-01 &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;
8  Improved    1976 53 years 10 months  265000 2021-04-01 &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;
9  Improved    1976 53 years 08 months  301000 2021-05-01 &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;
10 Improved    1976 53 years 05 months  322000 2021-09-01 &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;
            TOWN_y PROX_CB PROX_HA PROX_EL PROX_KI PROX_CH PROX_BU PROX_MR
1  KALLANG/WHAMPOA   0.011   0.105   0.024   0.297   0.510   4.712   0.001
2  KALLANG/WHAMPOA   0.011   0.105   0.024   0.297   0.510   4.712   0.001
3  KALLANG/WHAMPOA   0.011   0.105   0.024   0.297   0.510   4.712   0.001
4  KALLANG/WHAMPOA   0.011   0.105   0.024   0.297   0.510   4.712   0.001
5  KALLANG/WHAMPOA   0.011   0.105   0.024   0.297   0.510   4.712   0.001
6  KALLANG/WHAMPOA   0.011   0.105   0.024   0.297   0.510   4.712   0.001
7             &lt;NA&gt;   0.013   0.029   0.028   0.324   0.727   1.535   0.040
8             &lt;NA&gt;   0.013   0.029   0.028   0.324   0.727   1.535   0.040
9             &lt;NA&gt;   0.013   0.029   0.028   0.324   0.727   1.535   0.040
10            &lt;NA&gt;   0.013   0.029   0.028   0.324   0.727   1.535   0.040
   PROX_SC PROX_SU PROX_MA PROX_TO NUM_KIN NUM_CHI NUM_BUS NUM_SCH NUM_TOP
1    0.017   0.418   0.042   0.006       0       2      15       0       0
2    0.017   0.418   0.042   0.006       0       2      15       0       0
3    0.017   0.418   0.042   0.006       0       2      15       0       0
4    0.017   0.418   0.042   0.006       0       2      15       0       0
5    0.017   0.418   0.042   0.006       0       2      15       0       0
6    0.017   0.418   0.042   0.006       0       2      15       0       0
7    0.047   0.321   0.065   0.011       0       4       5       1       0
8    0.047   0.321   0.065   0.011       0       4       5       1       0
9    0.047   0.321   0.065   0.011       0       4       5       1       0
10   0.047   0.321   0.065   0.011       0       4       5       1       0
                    geometry       year age
1  POINT (30309.27 30830.82) 1979-01-01  42
2  POINT (30309.27 30830.82) 1979-01-01  42
3  POINT (30309.27 30830.82) 1979-01-01  42
4  POINT (30309.27 30830.82) 1979-01-01  44
5  POINT (30309.27 30830.82) 1979-01-01  43
6  POINT (30309.27 30830.82) 1979-01-01  42
7  POINT (39173.81 33678.86) 1976-01-01  45
8  POINT (39173.81 33678.86) 1976-01-01  45
9  POINT (39173.81 33678.86) 1976-01-01  45
10 POINT (39173.81 33678.86) 1976-01-01  46</code></pre>
</div>
</div>
</section>
<section id="save" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="save"><span class="header-section-number">6.6</span> save</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>final_resale_prices <span class="ot">&lt;-</span> resale_type_loc_sf</span>
<span id="cb93-2"><a href="#cb93-2"></a>final_resale_prices <span class="ot">&lt;-</span> final_resale_prices <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="#cb93-3"></a>        <span class="fu">rename</span>(<span class="st">"storey_range"</span> <span class="ot">=</span> <span class="st">"stry_rn"</span>,</span>
<span id="cb93-4"><a href="#cb93-4"></a>               <span class="st">"street_name"</span> <span class="ot">=</span> <span class="st">"strt_nm"</span>,</span>
<span id="cb93-5"><a href="#cb93-5"></a>               <span class="st">"flat_type"</span> <span class="ot">=</span> <span class="st">"flt_typ"</span>,</span>
<span id="cb93-6"><a href="#cb93-6"></a>               <span class="st">"floor_area_sqm"</span> <span class="ot">=</span> <span class="st">"flr_r_s"</span>,</span>
<span id="cb93-7"><a href="#cb93-7"></a>               <span class="st">"flat_model"</span> <span class="ot">=</span> <span class="st">"flt_mdl"</span>,</span>
<span id="cb93-8"><a href="#cb93-8"></a>               <span class="st">"lease_commence_date"</span> <span class="ot">=</span> <span class="st">"ls_cmm_"</span>,</span>
<span id="cb93-9"><a href="#cb93-9"></a>               <span class="st">"remaining_lease_original"</span> <span class="ot">=</span> <span class="st">"rmnng_l"</span>,</span>
<span id="cb93-10"><a href="#cb93-10"></a>               <span class="st">"resale_price"</span> <span class="ot">=</span> <span class="st">"rsl_prc"</span>,</span>
<span id="cb93-11"><a href="#cb93-11"></a>               <span class="st">"PROX_CBD"</span> <span class="ot">=</span> <span class="st">"PROX_CB"</span>,</span>
<span id="cb93-12"><a href="#cb93-12"></a>               <span class="st">"PROX_HAWKER"</span> <span class="ot">=</span> <span class="st">"PROX_HA"</span>,</span>
<span id="cb93-13"><a href="#cb93-13"></a>               <span class="st">"PROX_ELDERCARE"</span> <span class="ot">=</span> <span class="st">"PROX_EL"</span>,</span>
<span id="cb93-14"><a href="#cb93-14"></a>               <span class="st">"PROX_KINDERGARTEN"</span> <span class="ot">=</span> <span class="st">"PROX_KI"</span>,</span>
<span id="cb93-15"><a href="#cb93-15"></a>               <span class="st">"PROX_CHILDCARE"</span> <span class="ot">=</span> <span class="st">"PROX_CH"</span>,</span>
<span id="cb93-16"><a href="#cb93-16"></a>               <span class="st">"PROX_BUSSTOP"</span> <span class="ot">=</span> <span class="st">"PROX_BU"</span>,</span>
<span id="cb93-17"><a href="#cb93-17"></a>               <span class="st">"PROX_MRT"</span> <span class="ot">=</span> <span class="st">"PROX_MR"</span>,</span>
<span id="cb93-18"><a href="#cb93-18"></a>               <span class="st">"PROX_SCH"</span> <span class="ot">=</span> <span class="st">"PROX_SC"</span>,</span>
<span id="cb93-19"><a href="#cb93-19"></a>               <span class="st">"PROX_TOPSCH"</span> <span class="ot">=</span> <span class="st">"PROX_TO"</span>,</span>
<span id="cb93-20"><a href="#cb93-20"></a>               <span class="st">"PROX_SUPERMARKET"</span> <span class="ot">=</span> <span class="st">"PROX_SU"</span>,</span>
<span id="cb93-21"><a href="#cb93-21"></a>               <span class="st">"PROX_MALL"</span> <span class="ot">=</span> <span class="st">"PROX_MA"</span>,</span>
<span id="cb93-22"><a href="#cb93-22"></a>               <span class="st">"NUM_KINDERGARTEN"</span> <span class="ot">=</span> <span class="st">"NUM_KIN"</span>,</span>
<span id="cb93-23"><a href="#cb93-23"></a>               <span class="st">"NUM_CHILDCARE"</span> <span class="ot">=</span> <span class="st">"NUM_CHI"</span>,</span>
<span id="cb93-24"><a href="#cb93-24"></a>               <span class="st">"NUM_BUSSTOP"</span> <span class="ot">=</span> <span class="st">"NUM_BUS"</span>,</span>
<span id="cb93-25"><a href="#cb93-25"></a>               <span class="st">"NUM_TOPSCH"</span> <span class="ot">=</span> <span class="st">"NUM_TOP"</span>)</span>
<span id="cb93-26"><a href="#cb93-26"></a><span class="fu">names</span>(final_resale_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "block"                    "street_name"             
 [3] "month"                    "town"                    
 [5] "flat_type"                "storey_range"            
 [7] "floor_area_sqm"           "flat_model"              
 [9] "lease_commence_date"      "remaining_lease_original"
[11] "resale_price"             "date"                    
[13] "HIP"                      "TOWN_x"                  
[15] "MUP"                      "TOWN_y"                  
[17] "PROX_CBD"                 "PROX_HAWKER"             
[19] "PROX_ELDERCARE"           "PROX_KINDERGARTEN"       
[21] "PROX_CHILDCARE"           "PROX_BUSSTOP"            
[23] "PROX_MRT"                 "PROX_SCH"                
[25] "PROX_SUPERMARKET"         "PROX_MALL"               
[27] "PROX_TOPSCH"              "NUM_KINDERGARTEN"        
[29] "NUM_CHILDCARE"            "NUM_BUSSTOP"             
[31] "NUM_SCH"                  "NUM_TOPSCH"              
[33] "year"                     "age"                     
[35] "geometry"                </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">write_rds</span>(final_resale_prices, <span class="st">"data/model/final_resale_prices.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>final_resale_prices <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/final_resale_prices.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Exploratory Data Analysis</h1>
<section id="statistical-graphics" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="statistical-graphics"><span class="header-section-number">7.1</span> Statistical Graphics</h2>
<section id="central-business-district-1" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="central-business-district-1"><span class="header-section-number">7.1.1</span> Central Business District</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="fu">tm_shape</span>(cbd_sf) <span class="sc">+</span></span>
<span id="cb97-2"><a href="#cb97-2"></a>  <span class="fu">tm_fill</span>(<span class="st">"SUBZONE_N"</span>) <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Central Business District Map"</span>,</span>
<span id="cb97-5"><a href="#cb97-5"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb97-6"><a href="#cb97-6"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb97-7"><a href="#cb97-7"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb97-8"><a href="#cb97-8"></a>            <span class="at">legend.outside.position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="fu">head</span>(cbd_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 28896.26 ymin: 27914.19 xmax: 30794.28 ymax: 29517.49
Projected CRS: SVY21 / Singapore TM
        SUBZONE_N SUBZONE_C    PLN_AREA_N PLN_AREA_C       REGION_N REGION_C
1           ANSON    DTSZ10 DOWNTOWN CORE         DT CENTRAL REGION       CR
2   TANJONG PAGAR    DTSZ09 DOWNTOWN CORE         DT CENTRAL REGION       CR
3         MAXWELL    DTSZ07 DOWNTOWN CORE         DT CENTRAL REGION       CR
4           CECIL    DTSZ08 DOWNTOWN CORE         DT CENTRAL REGION       CR
5 CENTRAL SUBZONE    DTSZ11 DOWNTOWN CORE         DT CENTRAL REGION       CR
                        geometry
1 MULTIPOLYGON (((29201.07 28...
2 MULTIPOLYGON (((29612.3 286...
3 MULTIPOLYGON (((29341.73 29...
4 MULTIPOLYGON (((29917.52 29...
5 MULTIPOLYGON (((30436.73 29...</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="hawker-centres-1" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="hawker-centres-1"><span class="header-section-number">7.1.2</span> Hawker Centres</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5"></a><span class="fu">tm_shape</span>(hawkercentre_sf) <span class="sc">+</span> </span>
<span id="cb100-6"><a href="#cb100-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb100-7"><a href="#cb100-7"></a>          <span class="at">shape =</span> <span class="dv">22</span>,</span>
<span id="cb100-8"><a href="#cb100-8"></a>          <span class="at">col =</span> <span class="st">"#4287f5"</span>) <span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Supermarkets"</span>,</span>
<span id="cb100-10"><a href="#cb100-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb100-11"><a href="#cb100-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="fu">head</span>(hawkercentre_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 18 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 22042.51 ymin: 29650.7 xmax: 35955.52 ymax: 46139.03
Projected CRS: SVY21 / Singapore TM
                             NAME                DESCRIP
1     Market Street Hawker Centre New Replacement Centre
2    Marsiling Mall Hawker Centre New Replacement Centre
3    Margaret Drive Hawker Centre New Replacement Centre
4 Fernvale Hawker Centre &amp; Market             New Centre
5       One Punggol Hawker Centre             New Centre
                                        ADDRESSBU ADDRESSBL ADDRESSP
1                                    CapitaSpring        50    48940
2                                  Marsiling Mall         4   738623
3                                            &lt;NA&gt;       38A   142038
4 Fernvale Community Club, Hawker Centre &amp; Market        21   797650
5                                     One Punggol         1   828629
              ADDRESSS  LANDXAD  LANDYAD                 STATUS   AWARDED
1        Market Street 29874.82  29650.7 Existing (replacement) 17/7/2017
2  Woodlands Street 12 22042.51 46139.03 Existing (replacement)  4/9/2015
3       Margaret Drive  24816.7 31094.91 Existing (replacement) 11/5/2015
4 Sengkang West Avenue  32867.9 41500.77         Existing (new) 30/7/2018
5        Punggol Drive 35955.52 43336.13         Existing (new)  8/8/2018
    IMPLEME
1  1/8/2017
2  1/1/2016
3 2/12/2015
4 13/8/2018
5 29/8/2018
                                                                                                                                                   INFO_ON
1                                                                                                                           hawker centre/commercial space
2                                                                                                                          hawker centre/supermarket/shops
3                                                                                                      hawker centre/branch office/supermarket/shops/flats
4                                                                                                                      hawker centre/market/community club
5 hawker centre/Regional Library/Senior Care Centre/Branch Office/Child Development Centre/Blood Collection Centre/Kidney Dialysis Centre/Childcare Centre
     EST_ORI            ICON_NA
1 15/11/2021 HC icons_Opt 8.jpg
2  8/11/2017 HC icons_Opt 8.jpg
3  30/3/2022 HC icons_Opt 8.jpg
4  22/3/2022 HC icons_Opt 8.jpg
5  29/4/2022 HC icons_Opt 8.jpg
                                                                       PHOTOUR
1                                                                         &lt;NA&gt;
2 http://www.nea.gov.sg/images/default-source/Hawker-Centres-Division/mmhc.jpg
3                                                                         &lt;NA&gt;
4                                                                         &lt;NA&gt;
5                                                                         &lt;NA&gt;
                                ADDRESS_ APPROXI HUP_COM
1                                   &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;
2 Blk 4,Woodlands St 12,Singapore?738623    3661    &lt;NA&gt;
3                                   &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;
4                                   &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;
5                                   &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;
                   geometry
1  POINT (29874.82 29650.7)
2 POINT (22042.51 46139.03)
3  POINT (24816.7 31094.91)
4  POINT (32867.9 41500.77)
5 POINT (35955.52 43336.13)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="eldercare-centres-1" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="eldercare-centres-1"><span class="header-section-number">7.1.3</span> Eldercare Centres</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb103-2"><a href="#cb103-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb103-5"><a href="#cb103-5"></a><span class="fu">tm_shape</span>(eldercare_sf) <span class="sc">+</span> </span>
<span id="cb103-6"><a href="#cb103-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb103-7"><a href="#cb103-7"></a>          <span class="at">shape =</span> <span class="dv">24</span>,</span>
<span id="cb103-8"><a href="#cb103-8"></a>          <span class="at">col =</span> <span class="st">"#fcba03"</span>) <span class="sc">+</span></span>
<span id="cb103-9"><a href="#cb103-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Eldercare Centres"</span>,</span>
<span id="cb103-10"><a href="#cb103-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb103-11"><a href="#cb103-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="fu">head</span>(eldercare_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 14481.92 ymin: 30135.49 xmax: 38803.81 ymax: 36639.12
Projected CRS: SVY21 / Singapore TM
                                    NAME ADDRESSP
1           Yuhua Senior Activity Centre   601318
2                   THK SAC @ Kaki Bukit   462509
3                     THK SAC @ Boon Lay   640190
4 PEACE-Connect Senior Activity Centre@5   190005
5                 THK SAC @ Beo Crescent   160044
                               ADDRESSS                 ICON_NA
1     318A Jurong East Avenue 1 #02-308 onemap-fc-eldercare.png
2 Blk 509B Bedok North Street 3 #02-157 onemap-fc-eldercare.png
3        Blk 190 Boon Lay Drive #01-242 onemap-fc-eldercare.png
4                   5 Beach Rd #02-4943 onemap-fc-eldercare.png
5            Blk 44 Beo Crescent #01-67 onemap-fc-eldercare.png
                   geometry
1 POINT (16614.08 36639.12)
2 POINT (38803.81 35098.77)
3 POINT (14481.92 36357.61)
4 POINT (31505.35 31853.52)
5 POINT (27218.35 30135.49)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="parks-1" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="parks-1"><span class="header-section-number">7.1.4</span> Parks</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb106-3"><a href="#cb106-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb106-4"><a href="#cb106-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb106-5"><a href="#cb106-5"></a><span class="fu">tm_shape</span>(parks_sf) <span class="sc">+</span> </span>
<span id="cb106-6"><a href="#cb106-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb106-7"><a href="#cb106-7"></a>          <span class="at">shape =</span> <span class="dv">23</span>,</span>
<span id="cb106-8"><a href="#cb106-8"></a>          <span class="at">col =</span> <span class="st">"#32a852"</span>) <span class="sc">+</span></span>
<span id="cb106-9"><a href="#cb106-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Parks"</span>,</span>
<span id="cb106-10"><a href="#cb106-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb106-11"><a href="#cb106-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">head</span>(eldercare_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 14481.92 ymin: 30135.49 xmax: 38803.81 ymax: 36639.12
Projected CRS: SVY21 / Singapore TM
                                    NAME ADDRESSP
1           Yuhua Senior Activity Centre   601318
2                   THK SAC @ Kaki Bukit   462509
3                     THK SAC @ Boon Lay   640190
4 PEACE-Connect Senior Activity Centre@5   190005
5                 THK SAC @ Beo Crescent   160044
                               ADDRESSS                 ICON_NA
1     318A Jurong East Avenue 1 #02-308 onemap-fc-eldercare.png
2 Blk 509B Bedok North Street 3 #02-157 onemap-fc-eldercare.png
3        Blk 190 Boon Lay Drive #01-242 onemap-fc-eldercare.png
4                   5 Beach Rd #02-4943 onemap-fc-eldercare.png
5            Blk 44 Beo Crescent #01-67 onemap-fc-eldercare.png
                   geometry
1 POINT (16614.08 36639.12)
2 POINT (38803.81 35098.77)
3 POINT (14481.92 36357.61)
4 POINT (31505.35 31853.52)
5 POINT (27218.35 30135.49)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="kindergartens-1" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="kindergartens-1"><span class="header-section-number">7.1.5</span> Kindergartens</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="fu">tm_shape</span>(kindergartens_sf) <span class="sc">+</span> </span>
<span id="cb109-6"><a href="#cb109-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb109-7"><a href="#cb109-7"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb109-8"><a href="#cb109-8"></a>          <span class="at">col =</span> <span class="st">"#DE60B5"</span>) <span class="sc">+</span></span>
<span id="cb109-9"><a href="#cb109-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Kindergartens"</span>,</span>
<span id="cb109-10"><a href="#cb109-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb109-11"><a href="#cb109-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">head</span>(kindergartens_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 27354.73 ymin: 38859.25 xmax: 30705.05 ymax: 46300.26
Projected CRS: SVY21 / Singapore TM
                                                        NAME       DESCRIP
1 PCF Sparkletots Preschool @ Cheng San-Seletar Blk 435 (KN) Kindergartens
2 PCF Sparkletots Preschool @ Cheng San-Seletar Blk 533 (KN) Kindergartens
3 PCF Sparkletots Preschool @ Cheng San-Seletar Blk 556 (DS) Kindergartens
4        PCF Sparkletots Preschool @ Chong Pang Blk 107 (KN) Kindergartens
5        PCF Sparkletots Preschool @ Chong Pang Blk 122 (KN) Kindergartens
  ADDRESSP                                     ADDRESSS    ICON_NA
1   560435 435 Ang Mo Kio Avenue 10  #01-1393 S(560435) school.gif
2   560533  533 Ang Mo Kio Avenue 5  #01-4100 S(560533) school.gif
3   560556 556 Ang Mo Kio Avenue 10  #01-1902 S(560556) school.gif
4   760107      107 Yishun Ring Road  #01-207 S(760107) school.gif
5   760122      122 Yishun Street 11  #01-479 S(760122) school.gif
                   geometry
1 POINT (30325.45 38859.25)
2 POINT (30190.51 39574.18)
3  POINT (30705.05 39337.9)
4 POINT (27354.73 45992.92)
5 POINT (27755.87 46300.26)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="childcare-centres-1" class="level3" data-number="7.1.6">
<h3 data-number="7.1.6" class="anchored" data-anchor-id="childcare-centres-1"><span class="header-section-number">7.1.6</span> Childcare Centres</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb112-4"><a href="#cb112-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5"></a><span class="fu">tm_shape</span>(childcare_sf) <span class="sc">+</span> </span>
<span id="cb112-6"><a href="#cb112-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb112-7"><a href="#cb112-7"></a>          <span class="at">shape =</span> <span class="dv">25</span>,</span>
<span id="cb112-8"><a href="#cb112-8"></a>          <span class="at">col =</span> <span class="st">"#AB66C6"</span>) <span class="sc">+</span></span>
<span id="cb112-9"><a href="#cb112-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Childcare Centres"</span>,</span>
<span id="cb112-10"><a href="#cb112-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb112-11"><a href="#cb112-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">head</span>(childcare_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 17828.84 ymin: 29221.89 xmax: 40985.94 ymax: 45530.47
Projected CRS: SVY21 / Singapore TM
                                            NAME             DESCRIP ADDRESSP
1 APOLLO INTERNATIONAL PRESCHOOL PRIVATE LIMITED Child Care Services   467903
2                   APPLE TREE PLAYHOUSE PTE LTD Child Care Services   768019
3 Appleland Montessori Child Care Centre Pte Ltd Child Care Services   650165
4                            APPLELAND PLAYHOUSE Child Care Services   103104
5             APRICOT ACADEMY (LAGUNA) PTE. LTD. Child Care Services   449290
                                                               ADDRESSS
1                        44, LIMAU GARDEN, BEDOK PARK, SINGAPORE 467903
2     1, NORTHPOINT DRIVE, #02 - 201, NORTHPOINT CITY, SINGAPORE 768019
3           165, BUKIT BATOK WEST AVENUE 8, #01 - 286, SINGAPORE 650165
4                          104C, DEPOT ROAD, #01 - 03, SINGAPORE 103104
5 5000G, MARINE PARADE ROAD, #01 - 28/30, LAGUNA PARK, SINGAPORE 449290
                  ICON_NA                  geometry
1 onemap-fc-childcare.png POINT (40985.94 33848.38)
2 onemap-fc-childcare.png POINT (28308.65 45530.47)
3 onemap-fc-childcare.png POINT (17828.84 36607.36)
4 onemap-fc-childcare.png POINT (25579.73 29221.89)
5 onemap-fc-childcare.png POINT (38981.02 32483.41)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="bus-stops" class="level3" data-number="7.1.7">
<h3 data-number="7.1.7" class="anchored" data-anchor-id="bus-stops"><span class="header-section-number">7.1.7</span> Bus Stops</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb115-3"><a href="#cb115-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-5"><a href="#cb115-5"></a><span class="fu">tm_shape</span>(busstop_sf) <span class="sc">+</span> </span>
<span id="cb115-6"><a href="#cb115-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb115-7"><a href="#cb115-7"></a>          <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb115-8"><a href="#cb115-8"></a>          <span class="at">col =</span> <span class="st">"#CABE3E"</span>) <span class="sc">+</span></span>
<span id="cb115-9"><a href="#cb115-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Bus Stops"</span>,</span>
<span id="cb115-10"><a href="#cb115-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb115-11"><a href="#cb115-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="fu">head</span>(busstop_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 13228.59 ymin: 30391.85 xmax: 41603.76 ymax: 44206.38
Projected CRS: SVY21 / Singapore TM
  BUS_STOP_N BUS_ROOF_N             LOC_DESC                  geometry
1      22069        B06   OPP CEVA LOGISTICS POINT (13576.31 32883.65)
2      32071        B23         AFT TRACK 13 POINT (13228.59 44206.38)
3      44331        B01              BLK 239  POINT (21045.1 40242.08)
4      96081        B05 GRACE INDEPENDENT CH POINT (41603.76 35413.11)
5      11561        B05              BLK 166 POINT (24568.74 30391.85)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mrt-stations-1" class="level3" data-number="7.1.8">
<h3 data-number="7.1.8" class="anchored" data-anchor-id="mrt-stations-1"><span class="header-section-number">7.1.8</span> MRT Stations</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb118-2"><a href="#cb118-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb118-3"><a href="#cb118-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb118-4"><a href="#cb118-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb118-5"><a href="#cb118-5"></a><span class="fu">tm_shape</span>(mrt_sf) <span class="sc">+</span> </span>
<span id="cb118-6"><a href="#cb118-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb118-7"><a href="#cb118-7"></a>          <span class="at">shape =</span> <span class="dv">22</span>,</span>
<span id="cb118-8"><a href="#cb118-8"></a>          <span class="at">col =</span> <span class="st">"#FE9C1D"</span>) <span class="sc">+</span></span>
<span id="cb118-9"><a href="#cb118-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"MRT Stations"</span>,</span>
<span id="cb118-10"><a href="#cb118-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb118-11"><a href="#cb118-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="fu">head</span>(mrt_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 4 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 29286.74 ymin: 30548.91 xmax: 34623.54 ymax: 33404.47
Projected CRS: SVY21 / Singapore TM
  TYP_CD STN_NAM TYP_CD_DES              STN_NAM_DE
1      0    &lt;NA&gt;        MRT   ESPLANADE MRT STATION
2      0    &lt;NA&gt;        MRT  PAYA LEBAR MRT STATION
3      0    &lt;NA&gt;        MRT DHOBY GHAUT MRT STATION
4      0    &lt;NA&gt;        MRT      DAKOTA MRT STATION
5      0    &lt;NA&gt;        MRT    LAVENDER MRT STATION
                        geometry
1 POLYGON ((30566.07 30621.21...
2 POLYGON ((34495.6 33384.44,...
3 POLYGON ((29293.51 31312.53...
4 POLYGON ((34055.08 32290.62...
5 POLYGON ((31236.5 32085.76,...</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="primary-schools" class="level3" data-number="7.1.9">
<h3 data-number="7.1.9" class="anchored" data-anchor-id="primary-schools"><span class="header-section-number">7.1.9</span> Primary Schools</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb121-2"><a href="#cb121-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb121-3"><a href="#cb121-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb121-4"><a href="#cb121-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb121-5"><a href="#cb121-5"></a><span class="fu">tm_shape</span>(primarySch_ranking_sf) <span class="sc">+</span> </span>
<span id="cb121-6"><a href="#cb121-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb121-7"><a href="#cb121-7"></a>          <span class="at">shape =</span> <span class="dv">23</span>,</span>
<span id="cb121-8"><a href="#cb121-8"></a>          <span class="at">col =</span> <span class="st">"#BFBD9C"</span>) <span class="sc">+</span></span>
<span id="cb121-9"><a href="#cb121-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Primary Schools"</span>,</span>
<span id="cb121-10"><a href="#cb121-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb121-11"><a href="#cb121-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="fu">head</span>(primarySch_ranking_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 16 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 19496.7 ymin: 28588.52 xmax: 28735.3 ymax: 32798.72
Projected CRS: SVY21 / Singapore TM
  postalCode rank                  schoolName schoolZone
1     088256  182   Cantonment Primary School      South
2     099757  101              Chij (Kellock)      South
3     099840   27    Radin Mas Primary School      South
4     109100  168 Blangah Rise Primary School      South
5     128104   33         Qifa Primary School       West
                   address  schoolArea schoolStatus         affiliatedSchools
1       1 Cantonment Close Bukit Merah                                       
2      1 Bukit Teresa Road Bukit Merah              chij-st-theresa-s-convent
3    1 Bukit Purmei Avenue Bukit Merah                                       
4 91 Telok Blangah Heights Bukit Merah                                       
5     50 West Coast Avenue    Clementi                                       
  admissionRank sportsRank artsRank uniformedGroupsRank
1           132        153      163                 153
2           104         29       82                 163
3            10         74       83                  13
4           132        167      173                  61
5            61         26       10                 106
                   SCHOOLNAME SCH_HSE_BLK_NUM HSE_BLK_NUM         SCH_ROAD_NAME
1   CANTONMENT PRIMARY SCHOOL               1           1      CANTONMENT CLOSE
2              CHIJ (KELLOCK)               1           1     BUKIT TERESA ROAD
3    RADIN MAS PRIMARY SCHOOL               1           1   BUKIT PURMEI AVENUE
4 BLANGAH RISE PRIMARY SCHOOL              91          91 TELOK BLANGAH HEIGHTS
5         QIFA PRIMARY SCHOOL              50          50     WEST COAST AVENUE
                   geometry
1  POINT (28735.3 28695.24)
2 POINT (27413.63 28588.52)
3 POINT (26951.05 28619.79)
4 POINT (25215.83 28728.96)
5  POINT (19496.7 32798.72)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="supermarkets-1" class="level3" data-number="7.1.10">
<h3 data-number="7.1.10" class="anchored" data-anchor-id="supermarkets-1"><span class="header-section-number">7.1.10</span> Supermarkets</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="fu">tm_shape</span>(subzone_sf) <span class="sc">+</span></span>
<span id="cb124-2"><a href="#cb124-2"></a>  <span class="fu">tm_fill</span>() <span class="sc">+</span></span>
<span id="cb124-3"><a href="#cb124-3"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-4"><a href="#cb124-4"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-5"><a href="#cb124-5"></a><span class="fu">tm_shape</span>(supermarkets_sf) <span class="sc">+</span> </span>
<span id="cb124-6"><a href="#cb124-6"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.15</span>,</span>
<span id="cb124-7"><a href="#cb124-7"></a>          <span class="at">shape =</span> <span class="dv">24</span>,</span>
<span id="cb124-8"><a href="#cb124-8"></a>          <span class="at">col =</span> <span class="st">"#37F7C5"</span>) <span class="sc">+</span></span>
<span id="cb124-9"><a href="#cb124-9"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Supermarkets"</span>,</span>
<span id="cb124-10"><a href="#cb124-10"></a>            <span class="at">main.title.size =</span> <span class="fl">1.10</span>,</span>
<span id="cb124-11"><a href="#cb124-11"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="fu">head</span>(supermarkets_sf, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 8 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 32184.01 ymin: 32947.46 xmax: 41320.3 ymax: 42685.17
Projected CRS: SVY21 / Singapore TM
                                     LIC_NAME BLK_HOUSE             STR_NAME
1 LI LI CHENG SUPERMARKET (PUNGGOL) PTE. LTD.      273C        PUNGGOL PLACE
2             SHENG SIONG SUPERMARKET PTE LTD        11 UPPER BOON KENG ROAD
3       COLD STORAGE SINGAPORE (1983) PTE LTD       683     HOUGANG AVENUE 8
4       COLD STORAGE SINGAPORE (1983) PTE LTD       631 BEDOK RESERVOIR ROAD
5                     YES SUPERMARKET PTE LTD      201B   TAMPINES STREET 21
  UNIT_NO POSTCODE      LIC_NO          INC_CRC FMEL_UPD_D
1     884   823273 NE12I65N000 3DE8AF6E76F9D3D4 2017-11-29
2     901   380011  E73010V000 F361759A8261CD6E 2017-11-29
3     903   530683 NE11909C000 1DC69902E02077CE 2017-11-29
4     954   470631  S02210X000 4E2560154B58BA38 2017-11-29
5    1091   522201  S02037J000 559A9A00D9FF8A55 2017-11-29
                   geometry
1 POINT (35561.22 42685.17)
2 POINT (32184.01 32947.46)
3 POINT (33903.48 39480.46)
4 POINT (37083.82 35017.47)
5  POINT (41320.3 37283.82)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="ols-multiple-linear-regression-model" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> OLS Multiple Linear Regression Model</h1>
<section id="filtering" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="filtering"><span class="header-section-number">8.1</span> Filtering</h2>
<section id="train" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="train"><span class="header-section-number">8.1.1</span> Train</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>train_resale_prices <span class="ot">&lt;-</span> final_resale_prices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(date, <span class="fu">as.Date</span>(<span class="st">'2021-01-01'</span>), <span class="fu">as.Date</span>(<span class="st">'2022-12-01'</span>)))</span>
<span id="cb127-2"><a href="#cb127-2"></a>train_resale_prices <span class="ot">&lt;-</span> train_resale_prices[, <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">34</span>, <span class="dv">36</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="test"><span class="header-section-number">8.1.2</span> Test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>test_resale_prices <span class="ot">&lt;-</span> final_resale_prices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(date, <span class="fu">as.Date</span>(<span class="st">'2023-01-01'</span>), <span class="fu">as.Date</span>(<span class="st">'2023-02-01'</span>)))</span>
<span id="cb128-2"><a href="#cb128-2"></a>test_resale_prices <span class="ot">&lt;-</span> test_resale_prices[, <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">34</span>, <span class="dv">36</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>total_resale_prices <span class="ot">&lt;-</span> final_resale_prices[, <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">34</span>, <span class="dv">36</span>)]</span>
<span id="cb129-2"><a href="#cb129-2"></a><span class="fu">st_geometry</span>(total_resale_prices) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualising-the-relationships-of-the-independent-variables" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="visualising-the-relationships-of-the-independent-variables"><span class="header-section-number">8.2</span> Visualising the relationships of the independent variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(total_resale_prices), <span class="at">diag =</span> <span class="cn">FALSE</span>, <span class="at">order =</span> <span class="st">"AOE"</span>,</span>
<span id="cb130-2"><a href="#cb130-2"></a>         <span class="at">tl.pos =</span> <span class="st">"td"</span>, <span class="at">tl.cex =</span> <span class="fl">0.5</span>, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looks like age of the HDB flats and remaining lease are practically inversely correlated, which makes sense. So one will be removed, age will be removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb131-2"><a href="#cb131-2"></a>resale_price.mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> HIP <span class="sc">+</span> MUP <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_HAWKER <span class="sc">+</span>  PROX_ELDERCARE <span class="sc">+</span> PROX_KINDERGARTEN <span class="sc">+</span> PROX_CHILDCARE <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_MRT <span class="sc">+</span>  PROX_SUPERMARKET <span class="sc">+</span> PROX_MALL <span class="sc">+</span> PROX_TOPSCH <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUSSTOP <span class="sc">+</span> NUM_TOPSCH, <span class="at">data =</span> train_resale_prices)</span>
<span id="cb131-3"><a href="#cb131-3"></a><span class="fu">ols_regress</span>(resale_price.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb132-2"><a href="#cb132-2"></a>resale_price.mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> HIP <span class="sc">+</span> MUP <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_HAWKER <span class="sc">+</span>  PROX_ELDERCARE <span class="sc">+</span> PROX_CHILDCARE <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_MALL <span class="sc">+</span> PROX_TOPSCH <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_CHILDCARE  <span class="sc">+</span> NUM_SCH <span class="sc">+</span> NUM_TOPSCH, <span class="at">data =</span> train_resale_prices)</span>
<span id="cb132-3"><a href="#cb132-3"></a><span class="fu">ols_regress</span>(resale_price.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-publication-quality-table-gtsummary-method" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="preparing-publication-quality-table-gtsummary-method"><span class="header-section-number">8.3</span> Preparing Publication Quality Table: gtsummary method</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="fu">tbl_regression</span>(resale_price.mlr, <span class="at">intercept =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="fu">tbl_regression</span>(resale_price.mlr, </span>
<span id="cb134-2"><a href="#cb134-2"></a>               <span class="at">intercept =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb134-3"><a href="#cb134-3"></a>  <span class="fu">add_glance_source_note</span>(</span>
<span id="cb134-4"><a href="#cb134-4"></a>    <span class="at">label =</span> <span class="fu">list</span>(sigma <span class="sc">~</span> <span class="st">"\U03C3"</span>),</span>
<span id="cb134-5"><a href="#cb134-5"></a>    <span class="at">include =</span> <span class="fu">c</span>(r.squared, adj.r.squared, </span>
<span id="cb134-6"><a href="#cb134-6"></a>                AIC, statistic,</span>
<span id="cb134-7"><a href="#cb134-7"></a>                p.value, sigma))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-for-multicolinearity" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="checking-for-multicolinearity"><span class="header-section-number">8.4</span> Checking for multicolinearity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="fu">ols_vif_tol</span>(resale_price.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="fu">ols_plot_resid_fit</span>(resale_price.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">ols_plot_resid_hist</span>(resale_price.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testing-for-spatial-autocorrelation" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="testing-for-spatial-autocorrelation"><span class="header-section-number">8.5</span> Testing for Spatial Autocorrelation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>resale_price.mlr.output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(resale_price.mlr<span class="sc">$</span>residuals)</span>
<span id="cb138-2"><a href="#cb138-2"></a>final_resale_price.mlr.sf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(train_resale_prices, resale_price.mlr.output) <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="#cb138-3"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">MLR_RES</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">resale_price.mlr.residuals</span><span class="st">`</span>)</span>
<span id="cb138-4"><a href="#cb138-4"></a>final_resale_price.mlr.sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(final_resale_price.mlr.sf)</span>
<span id="cb138-5"><a href="#cb138-5"></a>final_resale_price.mlr.sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="map-10" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="map-10"><span class="header-section-number">8.5.1</span> Map</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="fu">tm_shape</span>(subzone_sf)<span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb139-5"><a href="#cb139-5"></a><span class="fu">tm_shape</span>(final_resale_price.mlr.sf) <span class="sc">+</span>  </span>
<span id="cb139-6"><a href="#cb139-6"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"MLR_RES"</span>,</span>
<span id="cb139-7"><a href="#cb139-7"></a>          <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb139-8"><a href="#cb139-8"></a>          <span class="at">style=</span><span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb139-9"><a href="#cb139-9"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>))</span>
<span id="cb139-10"><a href="#cb139-10"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(<span class="fu">coordinates</span>(final_resale_price.mlr.sp), <span class="dv">0</span>, <span class="dv">1500</span>, <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb140-2"><a href="#cb140-2"></a>nb_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, <span class="at">style =</span> <span class="st">'W'</span>)</span>
<span id="cb140-3"><a href="#cb140-3"></a><span class="fu">lm.morantest</span>(resale_price.mlr, nb_lw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="building-hedonic-pricing-models-using-gwmodel" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Building Hedonic Pricing Models using GWmodel</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>total_resale_prices <span class="ot">&lt;-</span> final_resale_prices[, <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">34</span>, <span class="dv">36</span>)]</span>
<span id="cb141-2"><a href="#cb141-2"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(total_resale_prices)</span>
<span id="cb141-3"><a href="#cb141-3"></a>coords_train <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(train_resale_prices)</span>
<span id="cb141-4"><a href="#cb141-4"></a>coords_test <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(test_resale_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="building-fixed-bandwidth-gwr-model" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="building-fixed-bandwidth-gwr-model"><span class="header-section-number">9.1</span> Building Fixed Bandwidth GWR Model</h2>
<section id="computing-fixed-bandwith" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="computing-fixed-bandwith"><span class="header-section-number">9.1.1</span> Computing fixed bandwith</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a>resale_price.sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(train_resale_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb143-2"><a href="#cb143-2"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> HIP <span class="sc">+</span> MUP <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_HAWKER <span class="sc">+</span>  PROX_ELDERCARE <span class="sc">+</span> PROX_KINDERGARTEN <span class="sc">+</span> PROX_CHILDCARE <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_MRT <span class="sc">+</span>  PROX_SUPERMARKET <span class="sc">+</span> PROX_MALL <span class="sc">+</span> PROX_TOPSCH <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUSSTOP <span class="sc">+</span> NUM_TOPSCH, </span>
<span id="cb143-3"><a href="#cb143-3"></a>                      <span class="at">data=</span>resale_price.sp, </span>
<span id="cb143-4"><a href="#cb143-4"></a>                      <span class="at">approach=</span><span class="st">"CV"</span>, </span>
<span id="cb143-5"><a href="#cb143-5"></a>                      <span class="at">kernel=</span><span class="st">"gaussian"</span>, </span>
<span id="cb143-6"><a href="#cb143-6"></a>                      <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb143-7"><a href="#cb143-7"></a>                      <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>787 is the most optimal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a>train_resale_prices <span class="ot">&lt;-</span> train_resale_prices <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="#cb144-2"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb145-2"><a href="#cb145-2"></a>rf <span class="ot">&lt;-</span> <span class="fu">ranger</span>(resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> HIP <span class="sc">+</span> MUP <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_HAWKER <span class="sc">+</span>  PROX_ELDERCARE <span class="sc">+</span> PROX_KINDERGARTEN <span class="sc">+</span> PROX_CHILDCARE <span class="sc">+</span> PROX_BUSSTOP <span class="sc">+</span> PROX_MRT <span class="sc">+</span>  PROX_SUPERMARKET <span class="sc">+</span> PROX_MALL <span class="sc">+</span> PROX_TOPSCH <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUSSTOP <span class="sc">+</span> NUM_TOPSCH,</span>
<span id="cb145-3"><a href="#cb145-3"></a>             <span class="at">data=</span>train_resale_prices)</span>
<span id="cb145-4"><a href="#cb145-4"></a><span class="fu">print</span>(rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb146-2"><a href="#cb146-2"></a>grf_adaptive <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> resale_price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> HIP <span class="sc">+</span> MUP <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_HAWKER <span class="sc">+</span>  PROX_ELDERCARE <span class="sc">+</span> PROX_KINDERGARTEN <span class="sc">+</span> PROX_CHILDCARE <span class="sc">+</span> PROX_SUPERMARKET <span class="sc">+</span> PROX_MALL <span class="sc">+</span> PROX_TOPSCH <span class="sc">+</span> NUM_KINDERGARTEN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUSSTOP <span class="sc">+</span> NUM_SCH <span class="sc">+</span> NUM_TOPSCH, </span>
<span id="cb146-3"><a href="#cb146-3"></a>                     <span class="at">dframe=</span>train_resale_prices,</span>
<span id="cb146-4"><a href="#cb146-4"></a>                     <span class="at">bw=</span><span class="dv">787</span>,</span>
<span id="cb146-5"><a href="#cb146-5"></a>                     <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb146-6"><a href="#cb146-6"></a>                     <span class="at">coords=</span>coords_train,</span>
<span id="cb146-7"><a href="#cb146-7"></a>                      <span class="at">ntree =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="fu">write_rds</span>(grf_adaptive, <span class="st">"data/model/grf_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a>grf_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/grf_adaptive.rds"</span>)</span>
<span id="cb148-2"><a href="#cb148-2"></a>grf_adaptive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_resale_prices, coords_test) <span class="sc">%&gt;%</span></span>
<span id="cb149-2"><a href="#cb149-2"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>gwRF_pred <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(grf_adaptive, </span>
<span id="cb150-2"><a href="#cb150-2"></a>                           test_data, </span>
<span id="cb150-3"><a href="#cb150-3"></a>                           <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb150-4"><a href="#cb150-4"></a>                           <span class="at">y.var.name=</span><span class="st">"Y"</span>, </span>
<span id="cb150-5"><a href="#cb150-5"></a>                           <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb150-6"><a href="#cb150-6"></a>                           <span class="at">global.w=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">write_rds</span>(gwRF_pred, <span class="st">"data/model/GRF_pred.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a>GRF_pred <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/GRF_pred.rds"</span>)</span>
<span id="cb152-2"><a href="#cb152-2"></a>GRF_pred_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(GRF_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a>test_data_p <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, GRF_pred_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a><span class="fu">write_rds</span>(test_data_p, <span class="st">"data/model/test_data_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="fu">rmse</span>(test_data_p<span class="sc">$</span>resale_price, </span>
<span id="cb155-2"><a href="#cb155-2"></a>     test_data_p<span class="sc">$</span>GRF_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb156-2"><a href="#cb156-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb156-3"><a href="#cb156-3"></a>           <span class="at">y =</span> resale_price)) <span class="sc">+</span></span>
<span id="cb156-4"><a href="#cb156-4"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>